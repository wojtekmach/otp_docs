<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.25.1">
    <meta name="project" content="kernel v8.0.2">

    <title>logger_formatter — kernel v8.0.2</title>
    <link rel="stylesheet" href="dist/erlang-951161c89561e05735a5.css" />

    <script src="dist/sidebar_items-69e02f009e.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/app-f97730d45ef67f3e6188.js"></script>


  </head>
  <body data-type="modules">
    <script>

      try {
        if (localStorage.getItem('night-mode') === 'true') {
          document.body.classList.add('night-mode');
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="api-reference.html" class="sidebar-projectName">
kernel
      </a>
      <strong class="sidebar-projectVersion">
        v8.0.2
      </strong>
    </div>

  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list-link" href="#full-list">Pages</a></li>

      <li><a id="modules-list-link" href="#full-list">Modules</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

      <h1>
logger_formatter <small class="app-vsn">(kernel v8.0.2)</small>

      </h1>


        <section id="moduledoc">
<p>Each Logger handler has a configured formatter specified as a module and a configuration term. The purpose of the formatter is to translate the log events to a final printable string (<a href="https://wojtekmach.pl/otp_docs/stdlib/unicode.html#t:chardata/0"><code>unicode:chardata()</code> </a>) which can be written to the output device of the handler. See sections Handlers and Formatters in the Kernel User's Guide for more information.</p><p><code>logger_formatter</code> is the default formatter used by Logger.</p><h2 id="module-see-also" class="section-heading">
  <a href="#module-see-also" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  See Also
</h2>
<p><a href="https://wojtekmach.pl/otp_docs/stdlib/calendar.html"><code>calendar(3)</code></a>, <a href="error_logger.html"><code>error_logger(3)</code></a>, <a href="https://wojtekmach.pl/otp_docs/stdlib/io.html"><code>io(3)</code></a>, <a href="https://wojtekmach.pl/otp_docs/stdlib/io_lib.html"><code>io_lib(3)</code></a>, <a href="logger.html"><code>logger(3)</code></a>, <a href="https://wojtekmach.pl/otp_docs/stdlib/maps.html"><code>maps(3)</code></a>, <code>sasl(6)</code>, <a href="https://wojtekmach.pl/otp_docs/stdlib/unicode.html"><code>unicode(3)</code></a></p>
        </section>


        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>

  <div class="summary-types summary">
    <h2>
      <a href="#types">Types</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:config/0">-type config() :: term().</a>

  </div>

    <div class="summary-synopsis"><p>The configuration term for <code>logger_formatter</code> is a <a href="https://wojtekmach.pl/otp_docs/stdlib/maps.html">map</a>, and the following keys can be set as configuration parameters</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:metakey/0">-type metakey() :: term().</a>

  </div>

    <div class="summary-synopsis"><p></p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:template/0">-type template() :: term().</a>

  </div>

    <div class="summary-synopsis"><p>The template is a list of atoms, atom lists, tuples and strings. The atoms <code>level</code> or <code>msg</code>, are treated as placeholders for the severity level and the log message, respectively. Other atoms or atom lists are interpreted as placeholders for metadata, where atoms are expected to match top level keys, and atom lists represent paths to sub keys when the metadata is a nested map. For example the list <code>[key1,key2]</code> is replaced by the value of the <code>key2</code> field in the nested map below. The atom <code>key1</code> on its own is replaced by the complete value of the <code>key1</code> field. The values are converted to strings.</p></div>

</div>

  </div>

  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#check_config/1">check_config/1</a>

  </div>

    <div class="summary-synopsis"><p>The function is called by Logger when the formatter configuration for a handler is set or modified. It returns <code>ok</code> if the configuration is valid, and <code>{error,term()}</code> if it is faulty.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#format/2">format/2</a>

  </div>

    <div class="summary-synopsis"><p>This the formatter callback function to be called from handlers. The log event is processed as follows</p></div>

</div>

  </div>

        </section>


        <section id="types" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#types">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Types
          </h1>
          <div class="types-list">
<section class="detail" id="t:config/0">

  <div class="detail-header">
    <a href="#t:config/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type config() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>config() ::
    #{chars_limit => pos_integer() | unlimited,
      depth => pos_integer() | unlimited,
      legacy_header => boolean(),
      max_size => pos_integer() | unlimited,
      report_cb => <a href="logger.html#t:report_cb/0">logger:report_cb</a>(),
      single_line => boolean(),
      template => <a href="#t:template/0">template</a>(),
      time_designator => byte(),
      time_offset => integer() | [byte()]}.</pre>

      </div>

<p>The configuration term for <code>logger_formatter</code> is a <a href="https://wojtekmach.pl/otp_docs/stdlib/maps.html">map</a>, and the following keys can be set as configuration parameters:</p><dl><dt><a id="chars_limit"></a><code>chars_limit = integer() &gt; 0 | unlimited</code></dt><dd><p>A positive integer representing the value of the option with the same name to be used when calling <a href="https://wojtekmach.pl/otp_docs/stdlib/io_lib.html#format/3"><code>io_lib:format/3</code></a>. This value limits the total number of characters printed for each log event. Notice that this is a soft limit. For a hard truncation limit, see option <code>max_size</code>.</p><p>Defaults to <code>unlimited</code>.</p></dd><dt><a id="depth"></a><code>depth = integer() &gt; 0 | unlimited</code></dt><dd><p>A positive integer representing the maximum depth to which terms shall be printed by this formatter. Format strings passed to this formatter are rewritten. The format controls ~p and ~w are replaced with ~P and ~W, respectively, and the value is used as the depth parameter. For details, see <a href="https://wojtekmach.pl/otp_docs/stdlib/io.html#format/2"><code>io:format/2,3</code></a> in STDLIB.</p><p>Defaults to <code>unlimited</code>.</p></dd><dt><code>legacy_header = boolean()</code></dt><dd><p>If set to <code>true</code> a header field is added to logger_formatter's part of <code>Metadata</code>. The value of this field is a string similar to the header created by the old <a href="error_logger.html"><code>error_logger</code></a> event handlers. It can be included in the log event by adding the list <code>[logger_formatter,header]</code> to the template. See the description of the <a href="logger_formatter.html#t:template/0"><code>template()</code></a> type for more information.</p><p>Defaults to <code>false</code>.</p></dd><dt><a id="max_size"></a><code>max_size = integer() &gt; 0 | unlimited</code></dt><dd><p>A positive integer representing the absolute maximum size a string returned from this formatter can have. If the formatted string is longer, after possibly being limited by <code>chars_limit</code> or <code>depth</code>, it is truncated.</p><p>Defaults to <code>unlimited</code>.</p></dd><dt><code>report_cb = </code><a href="logger.html#t:report_cb/0"><code>logger:report_cb()</code></a></dt><dd><p>A report callback is used by the formatter to transform log messages on report form to a format string and arguments. The report callback can be specified in the metadata for the log event. If no report callback exists in metadata, <code>logger_formatter</code> will use <a href="logger.html#format_report/1"><code>logger:format_report/1</code></a> as default callback.</p><p>If this configuration parameter is set, it replaces both the default report callback, and any report callback found in metadata. That is, all reports are converted by this configured function.</p></dd><dt><code>single_line = boolean()</code></dt><dd><p>If set to <code>true</code>, each log event is printed as a single line. To achieve this, <code>logger_formatter</code> sets the field width to <code>0</code> for all <code>~p</code> and <code>~P</code> control sequences in the format a string (see <a href="https://wojtekmach.pl/otp_docs/stdlib/io.html#format/2"><code>io:format/2</code></a>), and replaces all newlines in the message with <code>&quot;, &quot;</code>. White spaces following directly after newlines are removed. Notice that newlines added by the <code>template</code> parameter are not replaced.</p><p>Defaults to <code>true</code>.</p></dd><dt><a id="template"></a><code>template = </code><a href="logger_formatter.html#t:template/0"><code>template()</code></a></dt><dd><p>The template describes how the formatted string is composed by combining different data values from the log event. See the description of the <a href="logger_formatter.html#t:template/0"><code>template()</code></a> type for more information about this.</p></dd><dt><code>time_designator = byte()</code></dt><dd><p>Timestamps are formatted according to RFC3339, and the time designator is the character used as date and time separator.</p><p>Defaults to <code>$T</code>.</p><p>The value of this parameter is used as the <code>time_designator</code> option to <a href="https://wojtekmach.pl/otp_docs/stdlib/calendar.html#system_time_to_rfc3339/2"><code>calendar:system_time_to_rcf3339/2</code></a>.</p></dd><dt><code>time_offset = integer() | [byte()]</code></dt><dd><p>The time offset, either a string or an integer, to be used when formatting the timestamp.</p><p>An empty string is interpreted as local time. The values <code>&quot;Z&quot;</code>, <code>&quot;z&quot;</code> or <code>0</code> are interpreted as Universal Coordinated Time (UTC).</p><p>Strings, other than <code>&quot;Z&quot;</code>, <code>&quot;z&quot;</code>, or <code>&quot;&quot;</code>, must be on the form <code>±[hh]:[mm]</code>, for example <code>&quot;-02:00&quot;</code> or <code>&quot;+00:00&quot;</code>.</p><p>Integers must be in microseconds, meaning that the offset <code>7200000000</code> is equivalent to <code>&quot;+02:00&quot;</code>.</p><p>Defaults to an empty string, meaning that timestamps are displayed in local time. However, for backwards compatibility, if the SASL configuration parameter <code>utc_log</code><code>=true</code>, the default is changed to <code>&quot;Z&quot;</code>, meaning that timestamps are displayed in UTC.</p><p>The value of this parameter is used as the <code>offset</code> option to <a href="https://wojtekmach.pl/otp_docs/stdlib/calendar.html#system_time_to_rfc3339/2"><code>calendar:system_time_to_rcf3339/2</code></a>.</p></dd></dl>
  </section>
</section>
<section class="detail" id="t:metakey/0">

  <div class="detail-header">
    <a href="#t:metakey/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type metakey() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>metakey() :: atom() | [atom()].</pre>

      </div>

<p></p>
  </section>
</section>
<section class="detail" id="t:template/0">

  <div class="detail-header">
    <a href="#t:template/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type template() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>template() :: [<a href="#t:metakey/0">metakey</a>() | {<a href="#t:metakey/0">metakey</a>(), <a href="#t:template/0">template</a>(), <a href="#t:template/0">template</a>()} | <a href="https://wojtekmach.pl/otp_docs/stdlib/unicode.html#t:chardata/0">unicode:chardata</a>()].</pre>

      </div>

<p>The template is a list of atoms, atom lists, tuples and strings. The atoms <code>level</code> or <code>msg</code>, are treated as placeholders for the severity level and the log message, respectively. Other atoms or atom lists are interpreted as placeholders for metadata, where atoms are expected to match top level keys, and atom lists represent paths to sub keys when the metadata is a nested map. For example the list <code>[key1,key2]</code> is replaced by the value of the <code>key2</code> field in the nested map below. The atom <code>key1</code> on its own is replaced by the complete value of the <code>key1</code> field. The values are converted to strings.</p><pre><code class="makeup erlang"><span class="p" data-group-id="9340587893-1">#{</span><span class="ss">key1</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="9340587893-2">#{</span><span class="ss">key2</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">my_value</span><span class="p">,</span><span class="w">
            </span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="9340587893-2">}</span><span class="w">
  </span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="9340587893-1">}</span></code></pre><p>Tuples in the template express if-exist tests for metadata keys. For example, the following tuple says that if <code>key1</code> exists in the metadata map, print <code>&quot;key1=Value&quot;</code>, where <code>Value</code> is the value that <code>key1</code> is associated with in the metadata map. If <code>key1</code> does not exist, print nothing.</p><pre><code class="makeup erlang"><span class="p" data-group-id="1825920244-1">{</span><span class="ss">key1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1825920244-2">[</span><span class="s">&quot;key1=&quot;</span><span class="p">,</span><span class="ss">key1</span><span class="p" data-group-id="1825920244-2">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1825920244-3">[</span><span class="p" data-group-id="1825920244-3">]</span><span class="p" data-group-id="1825920244-1">}</span></code></pre><p>Strings in the template are printed literally.</p><p>The default value for the <code>template</code> configuration parameter depends on the value of the <code>single_line</code> and <code>legacy_header</code> configuration parameters as follows.</p><p>The log event used in the examples is:</p><pre><code class="makeup erlang"><span class="o">?</span><span class="n">LOG_ERROR</span><span class="p" data-group-id="5915052079-1">(</span><span class="s">&quot;name: </span><span class="si">~p</span><span class="si">~n</span><span class="s">exit_reason: </span><span class="si">~p</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5915052079-2">[</span><span class="ss">my_name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;It crashed&quot;</span><span class="p" data-group-id="5915052079-2">]</span><span class="p" data-group-id="5915052079-1">)</span></code></pre><dl><dt><code>legacy_header = true, single_line = false</code></dt><dd><p>Default template: <code>[[logger_formatter,header],&quot;\n&quot;,msg,&quot;\n&quot;]</code></p><p>Example log entry:</p><pre><code type="none">=ERROR REPORT==== 17-May-2018::18:30:19.453447 ===
name: my_name
exit_reason: &quot;It crashed&quot;</code></pre><p>Notice that all eight levels can occur in the heading, not only <code>ERROR</code>, <code>WARNING</code> or <code>INFO</code> as <a href="error_logger.html"><code>error_logger</code></a> produces. And microseconds are added at the end of the timestamp.</p></dd><dt><code>legacy_header = true, single_line = true</code></dt><dd><p>Default template: <code>[[logger_formatter,header],&quot;\n&quot;,msg,&quot;\n&quot;]</code></p><p>Notice that the template is here the same as for <code>single_line=false</code>, but the resulting log entry differs in that there is only one line after the heading:</p><pre><code type="none">=ERROR REPORT==== 17-May-2018::18:31:06.952665 ===
name: my_name, exit_reason: &quot;It crashed&quot;</code></pre></dd><dt><code>legacy_header = false, single_line = true</code></dt><dd><p>Default template: <code>[time,&quot; &quot;,level,&quot;: &quot;,msg,&quot;\n&quot;]</code></p><p>Example log entry:</p><pre><code type="none">2018-05-17T18:31:31.152864+02:00 error: name: my_name, exit_reason: &quot;It crashed&quot;</code></pre></dd><dt><code>legacy_header = false, single_line = false</code></dt><dd><p>Default template: <code>[time,&quot; &quot;,level,&quot;:\n&quot;,msg,&quot;\n&quot;]</code></p><p>Example log entry:</p><pre><code type="none">2018-05-17T18:32:20.105422+02:00 error:
name: my_name
exit_reason: &quot;It crashed&quot;</code></pre></dd></dl>
  </section>
</section>

          </div>
        </section>

        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Functions
          </h1>
          <div class="functions-list">
<section class="detail" id="check_config/1">

  <div class="detail-header">
    <a href="#check_config/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">check_config/1</h1>


      <span class="note">(since OTP 21.0)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>check_config(Config) -> ok | {error, term()} when Config :: <a href="#t:config/0">config</a>().</pre>

      </div>

<p>The function is called by Logger when the formatter configuration for a handler is set or modified. It returns <code>ok</code> if the configuration is valid, and <code>{error,term()}</code> if it is faulty.</p><p>The following Logger API functions can trigger this callback:</p><ul><li><a href="logger.html#add_handler/3"><code>logger:add_handler/3</code></a></li><li><a href="logger.html#set_handler_config/2"><code>logger:set_handler_config/2,3</code></a></li><li><a href="logger.html#update_handler_config/2"><code>logger:update_handler_config/2</code></a></li><li><a href="logger.html#update_formatter_config/2"><code>logger:update_formatter_config/2</code></a></li></ul>
  </section>
</section>
<section class="detail" id="format/2">

  <div class="detail-header">
    <a href="#format/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">format/2</h1>


      <span class="note">(since OTP 21.0)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>format(LogEvent, Config) -> <a href="https://wojtekmach.pl/otp_docs/stdlib/unicode.html#t:chardata/0">unicode:chardata</a>()
          when LogEvent :: <a href="logger.html#t:log_event/0">logger:log_event</a>(), Config :: <a href="#t:config/0">config</a>().</pre>

      </div>

<p>This the formatter callback function to be called from handlers. The log event is processed as follows:</p><ul><li>If the message is on report form, it is converted to <code>{Format,Args}</code> by calling the report callback. See section Log Message in the Kernel User's Guide for more information about report callbacks and valid forms of log messages.</li><li>The message size is limited according to the values of configuration parameters <a href="logger_formatter.html#content#chars_limit"><code>chars_limit</code></a> and <a href="logger_formatter.html#content#depth"><code>depth</code></a>.</li><li>The full log entry is composed according to the <a href="logger_formatter.html#content#template"><code>template</code></a>.</li><li>If the final string is too long, it is truncated according to the value of configuration parameter <a href="logger_formatter.html#content#max_size"><code>max_size</code></a>.</li></ul>
  </section>
</section>

          </div>
        </section>

      <footer class="footer">

        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.25.1) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>

            <a href="api-reference.html" title="API reference" class="line footer-button">API Reference</a>

          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
