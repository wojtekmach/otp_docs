<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.25.1">
    <meta name="project" content="public_key v1.11.1">

    <title>public_key â€” public_key v1.11.1</title>
    <link rel="stylesheet" href="dist/erlang-951161c89561e05735a5.css" />

    <script src="dist/sidebar_items-8d262ca1a2.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/app-f97730d45ef67f3e6188.js"></script>


  </head>
  <body data-type="modules">
    <script>

      try {
        if (localStorage.getItem('night-mode') === 'true') {
          document.body.classList.add('night-mode');
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="api-reference.html" class="sidebar-projectName">
public_key
      </a>
      <strong class="sidebar-projectVersion">
        v1.11.1
      </strong>
    </div>

  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list-link" href="#full-list">Pages</a></li>

      <li><a id="modules-list-link" href="#full-list">Modules</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

      <h1>
public_key <small class="app-vsn">(public_key v1.11.1)</small>

      </h1>


        <section id="moduledoc">
<p>Provides functions to handle public-key infrastructure, for details see public_key(6).</p><h2 id="module-common-records-and-asn-1-types" class="section-heading">
  <a href="#module-common-records-and-asn-1-types" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Common Records and ASN.1 Types
</h2>
<div class="note"><p>All records used in this Reference Manual are generated from ASN.1 specifications and are documented in the User's Guide. See Public-key Records.</p></div><p>Use the following include directive to get access to the records and constant macros described here and in the User's Guide:</p><pre><code class="makeup erlang"><span class="w"> </span><span class="p">-</span><span class="na">include_lib</span><span class="p" data-group-id="3519383151-1">(</span><span class="s">&quot;public_key/include/public_key.hrl&quot;</span><span class="p" data-group-id="3519383151-1">)</span><span class="p">.</span></code></pre>
        </section>


        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>

  <div class="summary-types summary">
    <h2>
      <a href="#types">Types</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:asn1_type/0">-type asn1_type() :: term().</a>

  </div>

    <div class="summary-synopsis"><p>ASN.1 type present in the Public Key applications ASN.1 specifications.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:cert_id/0">-type cert_id() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:cipher/0">-type cipher() :: term().</a>

  </div>

    <div class="summary-synopsis"><pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:cipher_info/0">-type cipher_info() :: term().</a>

  </div>

    <div class="summary-synopsis"><pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:cipher_info_params/0">-type cipher_info_params() :: term().</a>

  </div>

    <div class="summary-synopsis"><pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:crl_reason/0">-type crl_reason() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:der_encoded/0">-type der_encoded() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:der_or_encrypted_der/0">-type der_or_encrypted_der() :: term().</a>

  </div>

    <div class="summary-synopsis"><pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:digest_type/0">-type digest_type() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:dsa_private_key/0">-type dsa_private_key() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:dsa_public_key/0">-type dsa_public_key() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:ec_private_key/0">-type ec_private_key() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:ec_public_key/0">-type ec_public_key() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:ecpk_parameters/0">-type ecpk_parameters() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:ecpk_parameters_api/0">-type ecpk_parameters_api() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:ed_params/0">-type ed_params() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:ed_private_key/0">-type ed_private_key() :: term().</a>

  </div>

    <div class="summary-synopsis"><div class="warning"><p>The tagged ed_pri format will not be returned from any public_key functions but can be used as input, should be considered deprecated.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:ed_public_key/0">-type ed_public_key() :: term().</a>

  </div>

    <div class="summary-synopsis"><div class="warning"><p>The tagged ed_pub format will not be returned from any public_key functions but can be used as input, should be considered deprecated.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:issuer_name/0">-type issuer_name() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:key_params/0">-type key_params() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:oid/0">-type oid() :: term().</a>

  </div>

    <div class="summary-synopsis"><p>Object identifier, a tuple of integers as generated by the <code>ASN.1</code> compiler.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:pem_entry/0">-type pem_entry() :: term().</a>

  </div>

    <div class="summary-synopsis"><pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:pki_asn1_type/0">-type pki_asn1_type() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:private_key/0">-type private_key() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:public_key/0">-type public_key() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:rsa_private_key/0">-type rsa_private_key() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:rsa_pss_private_key/0">-type rsa_pss_private_key() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:rsa_pss_public_key/0">-type rsa_pss_public_key() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:rsa_public_key/0">-type rsa_public_key() :: term().</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:salt/0">-type salt() :: term().</a>

  </div>

    <div class="summary-synopsis"><pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:ssh_file/0">-type ssh_file() :: term().</a>

  </div>

</div>

  </div>

  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#compute_key/2">compute_key/2</a>

  </div>

    <div class="summary-synopsis"><p>Computes shared secret.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#compute_key/3">compute_key/3</a>

  </div>

    <div class="summary-synopsis"><p>Computes shared secret.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#decrypt_private/2">decrypt_private/2</a>

  </div>

    <div class="summary-synopsis"><p>Public-key decryption using the private key. See also <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#private_decrypt/4">crypto:private_decrypt/4</a></p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#decrypt_private/3">decrypt_private/3</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#decrypt_public/2">decrypt_public/2</a>

  </div>

    <div class="summary-synopsis"><p>Public-key decryption using the public key. See also <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#public_decrypt/4">crypto:public_decrypt/4</a></p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#decrypt_public/3">decrypt_public/3</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#der_decode/2">der_decode/2</a>

  </div>

    <div class="summary-synopsis"><p>Decodes a public-key ASN.1 DER encoded entity.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#der_encode/2">der_encode/2</a>

  </div>

    <div class="summary-synopsis"><p>Encodes a public-key entity with ASN.1 DER encoding.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#dh_gex_group/4">dh_gex_group/4</a>

  </div>

    <div class="summary-synopsis"><p>Selects a group for Diffie-Hellman key exchange with the key size in the range <code>MinSize...MaxSize</code> and as close to <code>SuggestedSize</code> as possible. If <code>Groups == undefined</code> a default set will be used, otherwise the group is selected from <code>Groups</code>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#encrypt_private/2">encrypt_private/2</a>

  </div>

    <div class="summary-synopsis"><p>Public-key encryption using the private key. See also <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#private_encrypt/4">crypto:private_encrypt/4</a>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#encrypt_private/3">encrypt_private/3</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#encrypt_public/2">encrypt_public/2</a>

  </div>

    <div class="summary-synopsis"><p>Public-key encryption using the public key. See also <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#public_encrypt/4">crypto:public_encrypt/4</a>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#encrypt_public/3">encrypt_public/3</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#generate_key/1">generate_key/1</a>

  </div>

    <div class="summary-synopsis"><p>Generates a new keypair. Note that except for Diffie-Hellman the public key is included in the private key structure. See also <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#generate_key/2">crypto:generate_key/2</a></p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pem_decode/1">pem_decode/1</a>

  </div>

    <div class="summary-synopsis"><p>Decodes PEM binary data and returns entries as ASN.1 DER encoded entities.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pem_encode/1">pem_encode/1</a>

  </div>

    <div class="summary-synopsis"><p>Creates a PEM binary.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pem_entry_decode/1">pem_entry_decode/1</a>

  </div>

    <div class="summary-synopsis"><p>Decodes a PEM entry. <code>pem_decode/1</code> returns a list of PEM entries. Notice that if the PEM entry is of type 'SubjectPublickeyInfo', it is further decoded to an <code>rsa_public_key()</code> or <code>dsa_public_key()</code>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pem_entry_decode/2">pem_entry_decode/2</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pem_entry_encode/2">pem_entry_encode/2</a>

  </div>

    <div class="summary-synopsis"><p>Creates a PEM entry that can be feed to <code>pem_encode/1</code>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pem_entry_encode/3">pem_entry_encode/3</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_crl_issuer/1">pkix_crl_issuer/1</a>

  </div>

    <div class="summary-synopsis"><p>Returns the issuer of the <code>CRL</code>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_crl_verify/2">pkix_crl_verify/2</a>

  </div>

    <div class="summary-synopsis"><p>Verify that <code>Cert</code> is the <code>CRL</code> signer.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_crls_validate/3">pkix_crls_validate/3</a>

  </div>

    <div class="summary-synopsis"><p>Performs CRL validation. It is intended to be called from the verify fun of <a href="public_key.html#pkix_path_validation/3">pkix_path_validation/3 </a>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_decode_cert/2">pkix_decode_cert/2</a>

  </div>

    <div class="summary-synopsis"><p>Decodes an ASN.1 DER-encoded PKIX certificate. Option <code>otp</code> uses the customized ASN.1 specification OTP-PKIX.asn1 for decoding and also recursively decode most of the standard parts.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_dist_point/1">pkix_dist_point/1</a>

  </div>

    <div class="summary-synopsis"><p>Creates a distribution point for CRLs issued by the same issuer as <code>Cert</code>. Can be used as input to <a href="public_key.html#pkix_crls_validate/3">pkix_crls_validate/3</a></p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_dist_points/1">pkix_dist_points/1</a>

  </div>

    <div class="summary-synopsis"><p>Extracts distribution points from the certificates extensions.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_encode/3">pkix_encode/3</a>

  </div>

    <div class="summary-synopsis"><p>DER encodes a PKIX x509 certificate or part of such a certificate. This function must be used for encoding certificates or parts of certificates that are decoded/created in the <code>otp</code> format, whereas for the plain format this function directly calls <code>der_encode/2</code>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_hash_type/1">pkix_hash_type/1</a>

  </div>

    <div class="summary-synopsis"><p>Translates OID to Erlang digest type</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_is_fixed_dh_cert/1">pkix_is_fixed_dh_cert/1</a>

  </div>

    <div class="summary-synopsis"><p>Checks if a certificate is a fixed Diffie-Hellman certificate.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_is_issuer/2">pkix_is_issuer/2</a>

  </div>

    <div class="summary-synopsis"><p>Checks if <code>IssuerCert</code> issued <code>Cert</code>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_is_self_signed/1">pkix_is_self_signed/1</a>

  </div>

    <div class="summary-synopsis"><p>Checks if a certificate is self-signed.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_issuer_id/2">pkix_issuer_id/2</a>

  </div>

    <div class="summary-synopsis"><p>Returns the x509 certificater issuer id, if it can be determined.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_match_dist_point/2">pkix_match_dist_point/2</a>

  </div>

    <div class="summary-synopsis"><p>Checks whether the given distribution point matches the Issuing Distribution Point of the CRL, as described in RFC 5280. If the CRL doesn't have an Issuing Distribution Point extension, the distribution point always matches.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_normalize_name/1">pkix_normalize_name/1</a>

  </div>

    <div class="summary-synopsis"><p>Normalizes an issuer name so that it can be easily compared to another issuer name.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_path_validation/3">pkix_path_validation(TrustedCert, CertChain, Options) -&gt; {ok, {PublicKeyInfo, PolicyTree}} | {error, {bad_cert, Reason}} </a>

  </div>

    <div class="summary-synopsis"><ul class="types"><li class="type">TrustedCert = #'OTPCertificate'{} | der_encoded() | atom()</li><li class="description">Normally a trusted certificate, but it can also be a path-validation error that can be discovered while constructing the input to this function and that is to be run through the <code>verify_fun</code>. Examples are <code>unknown_ca</code> and <code>selfsigned_peer.</code></li><li class="type">CertChain = [der_encoded()]</li><li class="description">A list of DER-encoded certificates in trust order ending with the peer certificate.</li><li class="type">Options = proplists:proplist()</li><li class="type">PublicKeyInfo = {?'rsaEncryption' | ?'id-RSASSA-PSS'| ?'id-dsa', rsa_public_key() | integer(), 'NULL' | 'RSASSA-PSS-params'{} | 'Dss-Parms'{}}</li><li class="type">PolicyTree = term()</li><li class="description">At the moment this is always an empty list as policies are not currently supported.</li><li class="type">Reason = cert_expired | invalid_issuer | invalid_signature | name_not_permitted | missing_basic_constraint | invalid_key_usage | {revoked, crl_reason()} | atom()</li></ul><p>Performs a basic path validation according to <a href="http://www.ietf.org/rfc/rfc5280.txt">RFC 5280.</a> However, CRL validation is done separately by <a href="public_key.html#pkix_crls_validate/3">pkix_crls_validate/3 </a>and is to be called from the supplied <code>verify_fun</code>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_sign/2">pkix_sign/2</a>

  </div>

    <div class="summary-synopsis"><p>Signs an 'OTPTBSCertificate'. Returns the corresponding DER-encoded certificate.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_sign_types/1">pkix_sign_types/1</a>

  </div>

    <div class="summary-synopsis"><p>Translates signature algorithm OID to Erlang digest and signature types.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_subject_id/1">pkix_subject_id/1</a>

  </div>

    <div class="summary-synopsis"><p>Returns the X509 certificate subject id.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_test_data/1">pkix_test_data([chain_opts()]) -&gt; [conf_opt()] pkix_test_data(Options) -&gt; Config </a>

  </div>

    <div class="summary-synopsis"><ul class="types"><li class="type">Options = #{chain_type() := chain_opts()}</li><li class="description">Options for ROOT, Intermediate and Peer certs</li><li class="type">chain_type() = server_chain | client_chain</li><li class="type">chain_opts() = #{root := [cert_opt()] | root_cert(), peer := [cert_opt()], intermediates =&gt; [[cert_opt()]]}</li><li class="description">A valid chain must have at least a ROOT and a peer cert. The root cert can be given either as a cert pre-generated by <a href="public_key.html#pkix_test_root_cert/2">pkix_test_root_cert/2 </a>, or as root cert generation options.</li><li class="type">root_cert() = #{cert := der_encoded(), key := Key}</li><li class="description">A root certificate generated by <a href="public_key.html#pkix_test_root_cert/2">pkix_test_root_cert/2 </a>.</li><li class="type">cert_opt() = {Key, Value}</li><li class="description">For available options see <a href="public_key.html#content#cert_opt">cert_opt()</a> below.</li><li class="type">Config = #{server_config := [conf_opt()], client_config := [conf_opt()]}</li><li class="type">conf_opt() = {cert, der_encoded()} | {key, PrivateKey} |{cacerts, [der_encoded()]}</li><li class="description">This is a subset of the type <a href="https://wojtekmach.pl/otp_docs/ssl/ssl.html#t:tls_option/0">ssl:tls_option()</a>. <code>PrivateKey</code> is what <a href="public_key.html#generate_key/1">generate_key/1</a> returns.</li></ul><p>Creates certificate configuration(s) consisting of certificate and its private key plus CA certificate bundle, for a client and a server, intended to facilitate automated testing of applications using X509-certificates, often through SSL/TLS. The test data can be used when you have control over both the client and the server in a test scenario.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_test_root_cert/2">pkix_test_root_cert(Name, Options) -&gt; RootCert</a>

  </div>

    <div class="summary-synopsis"><ul class="types"><li class="type">Name = string()</li><li class="description">The root certificate name.</li><li class="type">Options = [cert_opt()]</li><li class="description">For available options see <a href="public_key.html#content#cert_opt">cert_opt()</a> under <a href="public_key.html#pkix_test_data/1">pkix_test_data/1</a>.</li><li class="type">RootCert = #{cert := der_encoded(), key := Key}</li><li class="description">A root certificate and key. The <code>Key</code> is generated by <a href="public_key.html#generate_key/1">generate_key/1</a>.</li></ul><p>Generates a root certificate that can be used in multiple calls to <a href="public_key.html#pkix_test_data/1">pkix_test_data/1</a> when you want the same root certificate for several generated certificates.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_verify/2">pkix_verify/2</a>

  </div>

    <div class="summary-synopsis"><p>Verifies PKIX x.509 certificate signature.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_verify_hostname/2">pkix_verify_hostname(Cert, ReferenceIDs) -&gt; boolean()</a>

  </div>

    <div class="summary-synopsis"><ul class="types"><li class="type">Cert = der_encoded() | #'OTPCertificate'{}</li><li class="type">ReferenceIDs = [ RefID ]</li><li class="type">RefID = {dns_id,string()} | {srv_id,string()} | {uri_id,string()} | {ip,inet:ip_address()|string()} | {OtherRefID,term()}}</li><li class="type">OtherRefID = atom()</li><li class="type">Opts = [ PvhOpt() ]</li><li class="type">PvhOpt = [MatchOpt | FailCallBackOpt | FqdnExtractOpt]</li><li class="type">MatchOpt = {match_fun, fun(RefId | FQDN::string(), PresentedID) -&gt; boolean() | default}</li><li class="type">PresentedID = {dNSName,string()} | {uniformResourceIdentifier,string() | {iPAddress,list(byte())} | {OtherPresId,term()}}</li><li class="type">OtherPresID = atom()</li><li class="type">FailCallBackOpt = {fail_callback, fun(#'OTPCertificate'{}) -&gt; boolean()}</li><li class="type">FqdnExtractOpt = {fqdn_fun, fun(RefID) -&gt; FQDN::string() | default | undefined}</li></ul><p>This function checks that the <i>Presented Identifier</i> (e.g hostname) in a peer certificate is in agreement with at least one of the <i>Reference Identifier</i> that the client expects to be connected to. The function is intended to be added as an extra client check of the peer certificate when performing <a href="public_key.html#pkix_path_validation/3">public_key:pkix_path_validation/3</a></p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_verify_hostname/3">pkix_verify_hostname(Cert, ReferenceIDs, Opts) -&gt; boolean()</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#pkix_verify_hostname_match_fun/1">pkix_verify_hostname_match_fun(Protcol) -&gt;  fun(RefId | FQDN::string(), PresentedID) -&gt; boolean() | default</a>

  </div>

    <div class="summary-synopsis"><ul class="types"><li class="type">Protocol = https</li><li class="description">The algorithm for wich the fun should implement the special matching rules</li><li class="type">RefId</li><li class="description">See <a href="public_key.html#pkix_verify_hostname/3">pkix_verify_hostname/3</a>.</li><li class="type">FQDN</li><li class="description">See <a href="public_key.html#pkix_verify_hostname/3">pkix_verify_hostname/3</a>.</li><li class="type">PresentedID</li><li class="description">See <a href="public_key.html#pkix_verify_hostname/3">pkix_verify_hostname/3</a>.</li></ul><p>The return value of calling this function is intended to be used in the <code>match_fun</code> option in <a href="public_key.html#pkix_verify_hostname/3">pkix_verify_hostname/3</a>.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#short_name_hash/1">short_name_hash/1</a>

  </div>

    <div class="summary-synopsis"><p>Generates a short hash of an issuer name. The hash is returned as a string containing eight hexadecimal digits.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#sign/3">sign/3</a>

  </div>

    <div class="summary-synopsis"><p>Creates a digital signature.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#sign/4">sign/4</a>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#ssh_decode/2">ssh_decode/2</a>

      <span class="deprecated" title="public_key:ssh_decode/2 is deprecated and will be removed in OTP 26; use ssh_file:decode/2 instead">deprecated</span>

  </div>

    <div class="summary-synopsis"><div class="note"><p>This function is deprecated and should not be used in new programs. Use <a href="https://wojtekmach.pl/otp_docs/ssh/ssh_file.html#decode/2">ssh_file:decode/2</a> instead.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#ssh_encode/2">ssh_encode/2</a>

      <span class="deprecated" title="public_key:ssh_encode/2 is deprecated and will be removed in OTP 26; use ssh_file:encode/2 instead">deprecated</span>

  </div>

    <div class="summary-synopsis"><div class="note"><p>This function is deprecated and should not be used in new programs. Use <a href="https://wojtekmach.pl/otp_docs/ssh/ssh_file.html#encode/2">ssh_file:encode/2</a> instead.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#ssh_hostkey_fingerprint/1">ssh_hostkey_fingerprint(HostKey) -&gt; string()</a>

      <span class="deprecated" title="public_key:ssh_hostkey_fingerprint/1 is deprecated and will be removed in OTP 26; use ssh:hostkey_fingerprint/1 instead">deprecated</span>

  </div>

    <div class="summary-synopsis"><ul class="types"><li class="type">HostKey = <a href="public_key.html#t:public_key/0">public_key()</a></li><li class="type">DigestType = <a href="public_key.html#t:digest_type/0">digest_type()</a></li></ul><p>Calculates a ssh fingerprint from a public host key as openssh does.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#ssh_hostkey_fingerprint/2">ssh_hostkey_fingerprint([DigestType], HostKey) -&gt; [string()] ssh_hostkey_fingerprint(DigestType, HostKey) -&gt; string()</a>

      <span class="deprecated" title="public_key:ssh_hostkey_fingerprint/2 is deprecated and will be removed in OTP 26; use ssh:hostkey_fingerprint/2 instead">deprecated</span>

  </div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#verify/4">verify/4</a>

  </div>

    <div class="summary-synopsis"><p>Verifies a digital signature.</p></div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#verify/5">verify/5</a>

  </div>

</div>

  </div>

        </section>


        <section id="types" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#types">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Types
          </h1>
          <div class="types-list">
<section class="detail" id="t:asn1_type/0">

  <div class="detail-header">
    <a href="#t:asn1_type/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type asn1_type() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>asn1_type() :: atom().</pre>

      </div>

<p>ASN.1 type present in the Public Key applications ASN.1 specifications.</p>
  </section>
</section>
<section class="detail" id="t:cert_id/0">

  <div class="detail-header">
    <a href="#t:cert_id/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type cert_id() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>cert_id() :: {SerialNr :: integer(), <a href="#t:issuer_name/0">issuer_name</a>()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:cipher/0">

  <div class="detail-header">
    <a href="#t:cipher/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type cipher() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>cipher() :: string().</pre>

      </div>

<pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p>
  </section>
</section>
<section class="detail" id="t:cipher_info/0">

  <div class="detail-header">
    <a href="#t:cipher_info/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type cipher_info() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>cipher_info() :: {<a href="#t:cipher/0">cipher</a>(), <a href="#t:cipher_info_params/0">cipher_info_params</a>()}.</pre>

      </div>

<pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p>
  </section>
</section>
<section class="detail" id="t:cipher_info_params/0">

  <div class="detail-header">
    <a href="#t:cipher_info_params/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type cipher_info_params() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>cipher_info_params() :: <a href="#t:salt/0">salt</a>() | {#'PBEParameter'{}, <a href="#t:digest_type/0">digest_type</a>()} | #'PBES2-params'{}.</pre>

      </div>

<pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p>
  </section>
</section>
<section class="detail" id="t:crl_reason/0">

  <div class="detail-header">
    <a href="#t:crl_reason/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type crl_reason() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>crl_reason() ::
    unspecified | keyCompromise | cACompromise | affiliationChanged | superseded |
    cessationOfOperation | certificateHold | privilegeWithdrawn | aACompromise.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:der_encoded/0">

  <div class="detail-header">
    <a href="#t:der_encoded/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type der_encoded() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>der_encoded() :: binary().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:der_or_encrypted_der/0">

  <div class="detail-header">
    <a href="#t:der_or_encrypted_der/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type der_or_encrypted_der() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>der_or_encrypted_der() :: binary().</pre>

      </div>

<pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p>
  </section>
</section>
<section class="detail" id="t:digest_type/0">

  <div class="detail-header">
    <a href="#t:digest_type/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type digest_type() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>digest_type() ::
    none | sha1 | <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:rsa_digest_type/0">crypto:rsa_digest_type</a>() | <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:dss_digest_type/0">crypto:dss_digest_type</a>() | <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:ecdsa_digest_type/0">crypto:ecdsa_digest_type</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:dsa_private_key/0">

  <div class="detail-header">
    <a href="#t:dsa_private_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type dsa_private_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>dsa_private_key() :: #'DSAPrivateKey'{}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:dsa_public_key/0">

  <div class="detail-header">
    <a href="#t:dsa_public_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type dsa_public_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>dsa_public_key() :: {integer(), #'Dss-Parms'{}}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:ec_private_key/0">

  <div class="detail-header">
    <a href="#t:ec_private_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type ec_private_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ec_private_key() :: #'ECPrivateKey'{}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:ec_public_key/0">

  <div class="detail-header">
    <a href="#t:ec_public_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type ec_public_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ec_public_key() :: {#'ECPoint'{}, <a href="#t:ecpk_parameters_api/0">ecpk_parameters_api</a>()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:ecpk_parameters/0">

  <div class="detail-header">
    <a href="#t:ecpk_parameters/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type ecpk_parameters() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ecpk_parameters() :: {ecParameters, #'ECParameters'{}} | {namedCurve, Oid :: tuple()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:ecpk_parameters_api/0">

  <div class="detail-header">
    <a href="#t:ecpk_parameters_api/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type ecpk_parameters_api() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ecpk_parameters_api() ::
    <a href="#t:ecpk_parameters/0">ecpk_parameters</a>() | #'ECParameters'{} | {namedCurve, Name :: <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:ec_named_curve/0">crypto:ec_named_curve</a>()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:ed_params/0">

  <div class="detail-header">
    <a href="#t:ed_params/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type ed_params() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ed_params() :: {namedCurve, {1, 3, 101, 112} | {1, 3, 101, 113}}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:ed_private_key/0">

  <div class="detail-header">
    <a href="#t:ed_private_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type ed_private_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ed_private_key() ::
    #'ECPrivateKey'{parameters :: ed_params()} |
    {ed_pri, ed25519 | ed448, Pub :: binary(), Priv :: binary()}.</pre>

      </div>

<div class="warning"><p>The tagged ed_pri format will not be returned from any public_key functions but can be used as input, should be considered deprecated.</p></div>
  </section>
</section>
<section class="detail" id="t:ed_public_key/0">

  <div class="detail-header">
    <a href="#t:ed_public_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type ed_public_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ed_public_key() :: {#'ECPoint'{}, <a href="#t:ed_params/0">ed_params</a>()} | {ed_pub, ed25519 | ed448, Key :: binary()}.</pre>

      </div>

<div class="warning"><p>The tagged ed_pub format will not be returned from any public_key functions but can be used as input, should be considered deprecated.</p></div>
  </section>
</section>
<section class="detail" id="t:issuer_name/0">

  <div class="detail-header">
    <a href="#t:issuer_name/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type issuer_name() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>issuer_name() :: {rdnSequence, [[#'AttributeTypeAndValue'{}]]}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:key_params/0">

  <div class="detail-header">
    <a href="#t:key_params/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type key_params() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>key_params() ::
    #'DHParameter'{} |
    {namedCurve, <a href="#t:oid/0">oid</a>()} |
    #'ECParameters'{} |
    {rsa, Size :: integer(), PubExp :: integer()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:oid/0">

  <div class="detail-header">
    <a href="#t:oid/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type oid() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>oid() :: tuple().</pre>

      </div>

<p>Object identifier, a tuple of integers as generated by the <code>ASN.1</code> compiler.</p>
  </section>
</section>
<section class="detail" id="t:pem_entry/0">

  <div class="detail-header">
    <a href="#t:pem_entry/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type pem_entry() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pem_entry() :: {<a href="#t:pki_asn1_type/0">pki_asn1_type</a>(), <a href="#t:der_or_encrypted_der/0">der_or_encrypted_der</a>(), not_encrypted | <a href="#t:cipher_info/0">cipher_info</a>()}.</pre>

      </div>

<pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p>
  </section>
</section>
<section class="detail" id="t:pki_asn1_type/0">

  <div class="detail-header">
    <a href="#t:pki_asn1_type/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type pki_asn1_type() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pki_asn1_type() ::
    'Certificate' | 'RSAPrivateKey' | 'RSAPublicKey' | 'DSAPrivateKey' | 'DSAPublicKey' |
    'DHParameter' | 'SubjectPublicKeyInfo' | 'PrivateKeyInfo' | 'CertificationRequest' |
    'CertificateList' | 'ECPrivateKey' | 'EcpkParameters'.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:private_key/0">

  <div class="detail-header">
    <a href="#t:private_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type private_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>private_key() ::
    <a href="#t:rsa_private_key/0">rsa_private_key</a>() |
    <a href="#t:rsa_pss_private_key/0">rsa_pss_private_key</a>() |
    <a href="#t:dsa_private_key/0">dsa_private_key</a>() |
    <a href="#t:ec_private_key/0">ec_private_key</a>() |
    <a href="#t:ed_private_key/0">ed_private_key</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:public_key/0">

  <div class="detail-header">
    <a href="#t:public_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type public_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>public_key() ::
    <a href="#t:rsa_public_key/0">rsa_public_key</a>() | <a href="#t:rsa_pss_public_key/0">rsa_pss_public_key</a>() | <a href="#t:dsa_public_key/0">dsa_public_key</a>() | <a href="#t:ec_public_key/0">ec_public_key</a>() | <a href="#t:ed_public_key/0">ed_public_key</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:rsa_private_key/0">

  <div class="detail-header">
    <a href="#t:rsa_private_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type rsa_private_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>rsa_private_key() :: #'RSAPrivateKey'{}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:rsa_pss_private_key/0">

  <div class="detail-header">
    <a href="#t:rsa_pss_private_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type rsa_pss_private_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>rsa_pss_private_key() :: {#'RSAPrivateKey'{}, #'RSASSA-PSS-params'{}}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:rsa_pss_public_key/0">

  <div class="detail-header">
    <a href="#t:rsa_pss_public_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type rsa_pss_public_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>rsa_pss_public_key() :: {#'RSAPublicKey'{}, #'RSASSA-PSS-params'{}}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:rsa_public_key/0">

  <div class="detail-header">
    <a href="#t:rsa_public_key/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type rsa_public_key() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>rsa_public_key() :: #'RSAPublicKey'{}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:salt/0">

  <div class="detail-header">
    <a href="#t:salt/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type salt() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>salt() :: binary().</pre>

      </div>

<pre><code class="makeup erlang"><span class="n">Cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RC2-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-CBC&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s">&quot;DES-EDE3-CBC&quot;</span></code></pre><p><code>Salt</code> could be generated with <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#strong_rand_bytes/1"><code>crypto:strong_rand_bytes(8)</code></a>.</p>
  </section>
</section>
<section class="detail" id="t:ssh_file/0">

  <div class="detail-header">
    <a href="#t:ssh_file/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">-type ssh_file() :: term().</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ssh_file() :: openssh_public_key | rfc4716_public_key | known_hosts | auth_keys.</pre>

      </div>


  </section>
</section>

          </div>
        </section>

        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Functions
          </h1>
          <div class="functions-list">
<section class="detail" id="compute_key/2">

  <div class="detail-header">
    <a href="#compute_key/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">compute_key/2</h1>


      <span class="note">(since OTP R16B01)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>compute_key(OthersECDHkey, MyECDHkey) -> SharedSecret
               when
                   OthersECDHkey :: #'ECPoint'{},
                   MyECDHkey :: #'ECPrivateKey'{},
                   SharedSecret :: binary().</pre>

      </div>

<p>Computes shared secret.</p>
  </section>
</section>
<section class="detail" id="compute_key/3">

  <div class="detail-header">
    <a href="#compute_key/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">compute_key/3</h1>


      <span class="note">(since OTP R16B01)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>compute_key(OthersDHkey, MyDHkey, DHparms) -> SharedSecret
               when
                   OthersDHkey :: <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:dh_public/0">crypto:dh_public</a>(),
                   MyDHkey :: <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:dh_private/0">crypto:dh_private</a>(),
                   DHparms :: #'DHParameter'{},
                   SharedSecret :: binary().</pre>

      </div>

<p>Computes shared secret.</p>
  </section>
</section>
<section class="detail" id="decrypt_private/2">

  <div class="detail-header">
    <a href="#decrypt_private/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">decrypt_private/2</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>decrypt_private(CipherText, Key) -> PlainText
                   when CipherText :: binary(), Key :: <a href="#t:rsa_private_key/0">rsa_private_key</a>(), PlainText :: binary().</pre>

      </div>

<p>Public-key decryption using the private key. See also <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#private_decrypt/4">crypto:private_decrypt/4</a></p>
  </section>
</section>
<section class="detail" id="decrypt_private/3">

  <div class="detail-header">
    <a href="#decrypt_private/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">decrypt_private/3</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>decrypt_private(CipherText, Key, Options) -> PlainText
                   when
                       CipherText :: binary(),
                       Key :: <a href="#t:rsa_private_key/0">rsa_private_key</a>(),
                       Options :: <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:pk_encrypt_decrypt_opts/0">crypto:pk_encrypt_decrypt_opts</a>(),
                       PlainText :: binary().</pre>

      </div>


  </section>
</section>
<section class="detail" id="decrypt_public/2">

  <div class="detail-header">
    <a href="#decrypt_public/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">decrypt_public/2</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>decrypt_public(CipherText, Key) -> PlainText
                  when CipherText :: binary(), Key :: <a href="#t:rsa_public_key/0">rsa_public_key</a>(), PlainText :: binary().</pre>

      </div>

<p>Public-key decryption using the public key. See also <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#public_decrypt/4">crypto:public_decrypt/4</a></p>
  </section>
</section>
<section class="detail" id="decrypt_public/3">

  <div class="detail-header">
    <a href="#decrypt_public/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">decrypt_public/3</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>decrypt_public(CipherText, Key, Options) -> PlainText
                  when
                      CipherText :: binary(),
                      Key :: <a href="#t:rsa_public_key/0">rsa_public_key</a>(),
                      Options :: <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:pk_encrypt_decrypt_opts/0">crypto:pk_encrypt_decrypt_opts</a>(),
                      PlainText :: binary().</pre>

      </div>


  </section>
</section>
<section class="detail" id="der_decode/2">

  <div class="detail-header">
    <a href="#der_decode/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">der_decode/2</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>der_decode(Asn1Type, Der) -> Entity
              when Asn1Type :: <a href="#t:asn1_type/0">asn1_type</a>(), Der :: binary(), Entity :: term().</pre>

      </div>

<p>Decodes a public-key ASN.1 DER encoded entity.</p>
  </section>
</section>
<section class="detail" id="der_encode/2">

  <div class="detail-header">
    <a href="#der_encode/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">der_encode/2</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>der_encode(Asn1Type, Entity) -> Der
              when Asn1Type :: <a href="#t:asn1_type/0">asn1_type</a>(), Entity :: term(), Der :: binary().</pre>

      </div>

<p>Encodes a public-key entity with ASN.1 DER encoding.</p>
  </section>
</section>
<section class="detail" id="dh_gex_group/4">

  <div class="detail-header">
    <a href="#dh_gex_group/4" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">dh_gex_group/4</h1>


      <span class="note">(since OTP 18.2)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>dh_gex_group(MinSize, SuggestedSize, MaxSize, Groups) -> {ok, {Size, Group}} | {error, term()}
                when
                    MinSize :: pos_integer(),
                    SuggestedSize :: pos_integer(),
                    MaxSize :: pos_integer(),
                    Groups :: undefined | [{Size, [Group]}],
                    Size :: pos_integer(),
                    Group :: {G, P},
                    G :: pos_integer(),
                    P :: pos_integer().</pre>

      </div>

<p>Selects a group for Diffie-Hellman key exchange with the key size in the range <code>MinSize...MaxSize</code> and as close to <code>SuggestedSize</code> as possible. If <code>Groups == undefined</code> a default set will be used, otherwise the group is selected from <code>Groups</code>.</p><p>First a size, as close as possible to SuggestedSize, is selected. Then one group with that key size is randomly selected from the specified set of groups. If no size within the limits of <code>MinSize</code> and <code>MaxSize</code> is available, <code>{error,no_group_found}</code> is returned.</p><p>The default set of groups is listed in <code>lib/public_key/priv/moduli</code>. This file may be regenerated like this:</p><pre><code class="makeup erlang"><span class="err">	</span><span class="sc">$&gt;</span><span class="w"> </span><span class="ss">cd</span><span class="w"> </span><span class="sc">$E</span><span class="n">RL_TOP</span><span class="o">/</span><span class="ss">lib</span><span class="o">/</span><span class="ss">public_key</span><span class="o">/</span><span class="ss">priv</span><span class="o">/</span><span class="w">
</span><span class="err">	</span><span class="sc">$&gt;</span><span class="w"> </span><span class="ss">generate</span><span class="w">
         </span><span class="o">--</span><span class="o">--</span><span class="w"> </span><span class="ss">wait</span><span class="w"> </span><span class="ss">until</span><span class="w"> </span><span class="ss">all</span><span class="w"> </span><span class="ss">background</span><span class="w"> </span><span class="ss">jobs</span><span class="w"> </span><span class="ss">has</span><span class="w"> </span><span class="ss">finished</span><span class="p">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="ss">may</span><span class="w"> </span><span class="ss">take</span><span class="w"> </span><span class="ss">several</span><span class="w"> </span><span class="ss">days</span><span class="w"> </span><span class="o">!</span><span class="w">
</span><span class="err">	</span><span class="sc">$&gt;</span><span class="w"> </span><span class="ss">cat</span><span class="w"> </span><span class="ss">moduli</span><span class="o">-</span><span class="o">*</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="ss">moduli</span><span class="w">
</span><span class="err">	</span><span class="sc">$&gt;</span><span class="w"> </span><span class="ss">cd</span><span class="w"> </span><span class="p">.</span><span class="p">.</span><span class="p">;</span><span class="w"> </span><span class="ss">make</span><span class="w"> 
      </span></code></pre>
  </section>
</section>
<section class="detail" id="encrypt_private/2">

  <div class="detail-header">
    <a href="#encrypt_private/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">encrypt_private/2</h1>


      <span class="note">(since OTP 21.1,OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>encrypt_private(PlainText, Key) -> CipherText
                   when PlainText :: binary(), Key :: <a href="#t:rsa_private_key/0">rsa_private_key</a>(), CipherText :: binary().</pre>

      </div>

<p>Public-key encryption using the private key. See also <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#private_encrypt/4">crypto:private_encrypt/4</a>.</p>
  </section>
</section>
<section class="detail" id="encrypt_private/3">

  <div class="detail-header">
    <a href="#encrypt_private/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">encrypt_private/3</h1>


      <span class="note">(since OTP 21.1,OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>encrypt_private(PlainText, Key, Options) -> CipherText
                   when
                       PlainText :: binary(),
                       Key :: <a href="#t:rsa_private_key/0">rsa_private_key</a>(),
                       Options :: <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:pk_encrypt_decrypt_opts/0">crypto:pk_encrypt_decrypt_opts</a>(),
                       CipherText :: binary().</pre>

      </div>


  </section>
</section>
<section class="detail" id="encrypt_public/2">

  <div class="detail-header">
    <a href="#encrypt_public/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">encrypt_public/2</h1>


      <span class="note">(since OTP 21.1,OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>encrypt_public(PlainText, Key) -> CipherText
                  when PlainText :: binary(), Key :: <a href="#t:rsa_public_key/0">rsa_public_key</a>(), CipherText :: binary().</pre>

      </div>

<p>Public-key encryption using the public key. See also <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#public_encrypt/4">crypto:public_encrypt/4</a>.</p>
  </section>
</section>
<section class="detail" id="encrypt_public/3">

  <div class="detail-header">
    <a href="#encrypt_public/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">encrypt_public/3</h1>


      <span class="note">(since OTP 21.1,OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>encrypt_public(PlainText, Key, Options) -> CipherText
                  when
                      PlainText :: binary(),
                      Key :: <a href="#t:rsa_public_key/0">rsa_public_key</a>(),
                      Options :: <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:pk_encrypt_decrypt_opts/0">crypto:pk_encrypt_decrypt_opts</a>(),
                      CipherText :: binary().</pre>

      </div>


  </section>
</section>
<section class="detail" id="generate_key/1">

  <div class="detail-header">
    <a href="#generate_key/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">generate_key/1</h1>


      <span class="note">(since OTP R16B01)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>generate_key(DHparams | ECparams | RSAparams) -> DHkeys | ECkey | RSAkey
                when
                    DHparams :: #'DHParameter'{},
                    DHkeys :: {PublicDH :: binary(), PrivateDH :: binary()},
                    ECparams :: <a href="#t:ecpk_parameters_api/0">ecpk_parameters_api</a>(),
                    ECkey :: #'ECPrivateKey'{},
                    RSAparams :: {rsa, Size, PubExp},
                    Size :: pos_integer(),
                    PubExp :: pos_integer(),
                    RSAkey :: #'RSAPrivateKey'{}.</pre>

      </div>

<p>Generates a new keypair. Note that except for Diffie-Hellman the public key is included in the private key structure. See also <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#generate_key/2">crypto:generate_key/2</a></p>
  </section>
</section>
<section class="detail" id="pem_decode/1">

  <div class="detail-header">
    <a href="#pem_decode/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pem_decode/1</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pem_decode(binary()) -> [<a href="#t:pem_entry/0">pem_entry</a>()].</pre>

      </div>

<p>Decodes PEM binary data and returns entries as ASN.1 DER encoded entities.</p><p>Example <code>{ok, PemBin} = file:read_file(&quot;cert.pem&quot;). PemEntries = public_key:pem_decode(PemBin).</code></p>
  </section>
</section>
<section class="detail" id="pem_encode/1">

  <div class="detail-header">
    <a href="#pem_encode/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pem_encode/1</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pem_encode([<a href="#t:pem_entry/0">pem_entry</a>()]) -> binary().</pre>

      </div>

<p>Creates a PEM binary.</p>
  </section>
</section>
<section class="detail" id="pem_entry_decode/1">

  <div class="detail-header">
    <a href="#pem_entry_decode/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pem_entry_decode/1</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pem_entry_decode(PemEntry) -> term() when PemEntry :: <a href="#t:pem_entry/0">pem_entry</a>().</pre>

      </div>

<p>Decodes a PEM entry. <code>pem_decode/1</code> returns a list of PEM entries. Notice that if the PEM entry is of type 'SubjectPublickeyInfo', it is further decoded to an <code>rsa_public_key()</code> or <code>dsa_public_key()</code>.</p>
  </section>
</section>
<section class="detail" id="pem_entry_decode/2">

  <div class="detail-header">
    <a href="#pem_entry_decode/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pem_entry_decode/2</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pem_entry_decode(PemEntry, Password) -> term() when PemEntry :: <a href="#t:pem_entry/0">pem_entry</a>(), Password :: string().</pre>

      </div>


  </section>
</section>
<section class="detail" id="pem_entry_encode/2">

  <div class="detail-header">
    <a href="#pem_entry_encode/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pem_entry_encode/2</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pem_entry_encode(Asn1Type, Entity) -> <a href="#t:pem_entry/0">pem_entry</a>()
                    when Asn1Type :: <a href="#t:pki_asn1_type/0">pki_asn1_type</a>(), Entity :: term().</pre>

      </div>

<p>Creates a PEM entry that can be feed to <code>pem_encode/1</code>.</p><p>If <code>Asn1Type</code> is <code>'SubjectPublicKeyInfo'</code>, <code>Entity</code> must be either an <code>rsa_public_key()</code>, <code>dsa_public_key()</code> or an <code>ec_public_key()</code> and this function creates the appropriate <code>'SubjectPublicKeyInfo'</code> entry.</p>
  </section>
</section>
<section class="detail" id="pem_entry_encode/3">

  <div class="detail-header">
    <a href="#pem_entry_encode/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pem_entry_encode/3</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pem_entry_encode(Asn1Type, Entity, InfoPwd) -> <a href="#t:pem_entry/0">pem_entry</a>()
                    when
                        Asn1Type :: <a href="#t:pki_asn1_type/0">pki_asn1_type</a>(),
                        Entity :: term(),
                        InfoPwd :: {CipherInfo, Password},
                        CipherInfo :: <a href="#t:cipher_info/0">cipher_info</a>(),
                        Password :: string().</pre>

      </div>


  </section>
</section>
<section class="detail" id="pkix_crl_issuer/1">

  <div class="detail-header">
    <a href="#pkix_crl_issuer/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_crl_issuer/1</h1>


      <span class="note">(since OTP 17.5)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_crl_issuer(CRL | #'CertificateList'{}) -> Issuer
                   when CRL :: <a href="#t:der_encoded/0">der_encoded</a>(), Issuer :: <a href="#t:issuer_name/0">issuer_name</a>().</pre>

      </div>

<p>Returns the issuer of the <code>CRL</code>.</p>
  </section>
</section>
<section class="detail" id="pkix_crl_verify/2">

  <div class="detail-header">
    <a href="#pkix_crl_verify/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_crl_verify/2</h1>


      <span class="note">(since OTP 17.5)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_crl_verify(CRL, Cert) -> boolean()
                   when
                       CRL :: <a href="#t:der_encoded/0">der_encoded</a>() | #'CertificateList'{},
                       Cert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{}.</pre>

      </div>

<p>Verify that <code>Cert</code> is the <code>CRL</code> signer.</p>
  </section>
</section>
<section class="detail" id="pkix_crls_validate/3">

  <div class="detail-header">
    <a href="#pkix_crls_validate/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_crls_validate/3</h1>


      <span class="note">(since OTP R16B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_crls_validate(OTPcertificate, DPandCRLs, Options) -> CRLstatus
                      when
                          OTPcertificate :: #'OTPCertificate'{},
                          DPandCRLs :: [DPandCRL],
                          DPandCRL :: {DP, {DerCRL, CRL}},
                          DP :: #'DistributionPoint'{},
                          DerCRL :: <a href="#t:der_encoded/0">der_encoded</a>(),
                          CRL :: #'CertificateList'{},
                          Options :: [{atom(), term()}],
                          CRLstatus :: valid | {bad_cert, BadCertReason},
                          BadCertReason ::
                              revocation_status_undetermined |
                              {revocation_status_undetermined, Reason :: term()} |
                              {revoked, <a href="#t:crl_reason/0">crl_reason</a>()}.</pre>

      </div>

<p>Performs CRL validation. It is intended to be called from the verify fun of <a href="public_key.html#pkix_path_validation/3">pkix_path_validation/3 </a>.</p><p>Available options:</p><dl><dt>{update_crl, fun()}</dt><dd><p>The fun has the following type specification:</p><pre><code class="makeup erlang"><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="8618953423-1">(</span><span class="o">#</span><span class="ss">&#39;DistributionPoint&#39;</span><span class="p" data-group-id="8618953423-2">{</span><span class="p" data-group-id="8618953423-2">}</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">&#39;CertificateList&#39;</span><span class="p" data-group-id="8618953423-3">{</span><span class="p" data-group-id="8618953423-3">}</span><span class="p" data-group-id="8618953423-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
        </span><span class="o">#</span><span class="ss">&#39;CertificateList&#39;</span><span class="p" data-group-id="8618953423-4">{</span><span class="p" data-group-id="8618953423-4">}</span></code></pre><p>The fun uses the information in the distribution point to access the latest possible version of the CRL. If this fun is not specified, Public Key uses the default implementation:</p><pre><code class="makeup erlang"><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="8823791667-1">(</span><span class="p">_</span><span class="n">DP</span><span class="p">,</span><span class="w"> </span><span class="n">CRL</span><span class="p" data-group-id="8823791667-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">CRL</span><span class="w"> </span><span class="k">end</span></code></pre></dd><dt>{issuer_fun, fun()}</dt><dd><p>The fun has the following type specification:</p><pre><code class="makeup erlang"><span class="nf">fun</span><span class="p" data-group-id="9400970176-1">(</span><span class="o">#</span><span class="ss">&#39;DistributionPoint&#39;</span><span class="p" data-group-id="9400970176-2">{</span><span class="p" data-group-id="9400970176-2">}</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">&#39;CertificateList&#39;</span><span class="p" data-group-id="9400970176-3">{</span><span class="p" data-group-id="9400970176-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="9400970176-4">{</span><span class="ss">rdnSequence</span><span class="p">,</span><span class="p" data-group-id="9400970176-5">[</span><span class="o">#</span><span class="ss">&#39;AttributeTypeAndValue&#39;</span><span class="p" data-group-id="9400970176-6">{</span><span class="p" data-group-id="9400970176-6">}</span><span class="p" data-group-id="9400970176-5">]</span><span class="p" data-group-id="9400970176-4">}</span><span class="p">,</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="9400970176-7">(</span><span class="p" data-group-id="9400970176-7">)</span><span class="p" data-group-id="9400970176-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
</span><span class="err">	</span><span class="p" data-group-id="9400970176-8">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">&#39;OTPCertificate&#39;</span><span class="p" data-group-id="9400970176-9">{</span><span class="p" data-group-id="9400970176-9">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9400970176-10">[</span><span class="ss">der_encoded</span><span class="p" data-group-id="9400970176-10">]</span><span class="p" data-group-id="9400970176-8">}</span></code></pre><p>The fun returns the root certificate and certificate chain that has signed the CRL.</p><pre><code class="makeup erlang"><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="1936597199-1">(</span><span class="n">DP</span><span class="p">,</span><span class="w"> </span><span class="n">CRL</span><span class="p">,</span><span class="w"> </span><span class="n">Issuer</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="1936597199-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="1936597199-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">RootCert</span><span class="p">,</span><span class="w"> </span><span class="n">CertChain</span><span class="p" data-group-id="1936597199-2">}</span></code></pre></dd><dt>{undetermined_details, boolean()}</dt><dd><p>Defaults to false. When revocation status cannot be determined, and this option is set to true, details of why no CRLs where accepted are included in the return value.</p></dd></dl>
  </section>
</section>
<section class="detail" id="pkix_decode_cert/2">

  <div class="detail-header">
    <a href="#pkix_decode_cert/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_decode_cert/2</h1>


  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_decode_cert(Cert, Type) -> #'Certificate'{} | #'OTPCertificate'{}
                    when Cert :: <a href="#t:der_encoded/0">der_encoded</a>(), Type :: plain | otp.</pre>

      </div>

<p>Decodes an ASN.1 DER-encoded PKIX certificate. Option <code>otp</code> uses the customized ASN.1 specification OTP-PKIX.asn1 for decoding and also recursively decode most of the standard parts.</p>
  </section>
</section>
<section class="detail" id="pkix_dist_point/1">

  <div class="detail-header">
    <a href="#pkix_dist_point/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_dist_point/1</h1>


      <span class="note">(since OTP 17.5)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_dist_point(Cert) -> DistPoint
                   when
                       Cert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{},
                       DistPoint :: #'DistributionPoint'{}.</pre>

      </div>

<p>Creates a distribution point for CRLs issued by the same issuer as <code>Cert</code>. Can be used as input to <a href="public_key.html#pkix_crls_validate/3">pkix_crls_validate/3</a></p>
  </section>
</section>
<section class="detail" id="pkix_dist_points/1">

  <div class="detail-header">
    <a href="#pkix_dist_points/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_dist_points/1</h1>


      <span class="note">(since OTP 17.5)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_dist_points(Cert) -> DistPoints
                    when
                        Cert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{},
                        DistPoints :: [#'DistributionPoint'{}].</pre>

      </div>

<p>Extracts distribution points from the certificates extensions.</p>
  </section>
</section>
<section class="detail" id="pkix_encode/3">

  <div class="detail-header">
    <a href="#pkix_encode/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_encode/3</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_encode(Asn1Type, Entity, Type) -> Der
               when
                   Asn1Type :: <a href="#t:asn1_type/0">asn1_type</a>(),
                   Entity :: term(),
                   Type :: otp | plain,
                   Der :: <a href="#t:der_encoded/0">der_encoded</a>().</pre>

      </div>

<p>DER encodes a PKIX x509 certificate or part of such a certificate. This function must be used for encoding certificates or parts of certificates that are decoded/created in the <code>otp</code> format, whereas for the plain format this function directly calls <code>der_encode/2</code>.</p>
  </section>
</section>
<section class="detail" id="pkix_hash_type/1">

  <div class="detail-header">
    <a href="#pkix_hash_type/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_hash_type/1</h1>


      <span class="note">(since OTP 23.0)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_hash_type(HashOid :: <a href="#t:oid/0">oid</a>()) -> DigestType :: md5 | <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:sha1/0">crypto:sha1</a>() | <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:sha2/0">crypto:sha2</a>().</pre>

      </div>

<p>Translates OID to Erlang digest type</p>
  </section>
</section>
<section class="detail" id="pkix_is_fixed_dh_cert/1">

  <div class="detail-header">
    <a href="#pkix_is_fixed_dh_cert/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_is_fixed_dh_cert/1</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_is_fixed_dh_cert(Cert) -> boolean() when Cert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{}.</pre>

      </div>

<p>Checks if a certificate is a fixed Diffie-Hellman certificate.</p>
  </section>
</section>
<section class="detail" id="pkix_is_issuer/2">

  <div class="detail-header">
    <a href="#pkix_is_issuer/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_is_issuer/2</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_is_issuer(Cert, IssuerCert) -> boolean()
                  when
                      Cert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{} | #'CertificateList'{},
                      IssuerCert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{}.</pre>

      </div>

<p>Checks if <code>IssuerCert</code> issued <code>Cert</code>.</p>
  </section>
</section>
<section class="detail" id="pkix_is_self_signed/1">

  <div class="detail-header">
    <a href="#pkix_is_self_signed/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_is_self_signed/1</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_is_self_signed(Cert) -> boolean() when Cert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{}.</pre>

      </div>

<p>Checks if a certificate is self-signed.</p>
  </section>
</section>
<section class="detail" id="pkix_issuer_id/2">

  <div class="detail-header">
    <a href="#pkix_issuer_id/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_issuer_id/2</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_issuer_id(Cert, IssuedBy) -> {ok, ID :: <a href="#t:cert_id/0">cert_id</a>()} | {error, Reason}
                  when
                      Cert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{},
                      IssuedBy :: self | other,
                      Reason :: term().</pre>

      </div>

<p>Returns the x509 certificater issuer id, if it can be determined.</p>
  </section>
</section>
<section class="detail" id="pkix_match_dist_point/2">

  <div class="detail-header">
    <a href="#pkix_match_dist_point/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_match_dist_point/2</h1>


      <span class="note">(since OTP 19.0)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_match_dist_point(CRL, DistPoint) -> boolean()
                         when
                             CRL :: <a href="#t:der_encoded/0">der_encoded</a>() | #'CertificateList'{},
                             DistPoint :: #'DistributionPoint'{}.</pre>

      </div>

<p>Checks whether the given distribution point matches the Issuing Distribution Point of the CRL, as described in RFC 5280. If the CRL doesn't have an Issuing Distribution Point extension, the distribution point always matches.</p>
  </section>
</section>
<section class="detail" id="pkix_normalize_name/1">

  <div class="detail-header">
    <a href="#pkix_normalize_name/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_normalize_name/1</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_normalize_name(Issuer) -> Normalized
                       when Issuer :: <a href="#t:issuer_name/0">issuer_name</a>(), Normalized :: <a href="#t:issuer_name/0">issuer_name</a>().</pre>

      </div>

<p>Normalizes an issuer name so that it can be easily compared to another issuer name.</p>
  </section>
</section>
<section class="detail" id="pkix_path_validation/3">

  <div class="detail-header">
    <a href="#pkix_path_validation/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_path_validation(TrustedCert, CertChain, Options) -&gt; {ok, {PublicKeyInfo, PolicyTree}} | {error, {bad_cert, Reason}} </h1>


      <span class="note">(since OTP R16B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_path_validation(Cert :: binary() | #'OTPCertificate'{} | atom(),
                     CertChain :: [binary() | #'OTPCertificate'{}],
                     Options :: [{atom(), term()}]) ->
                        {ok, {PublicKeyInfo :: term(), PolicyTree :: term()}} |
                        {error, {bad_cert, Reason :: term()}}.</pre>

      </div>

<ul class="types"><li class="type">TrustedCert = #'OTPCertificate'{} | der_encoded() | atom()</li><li class="description">Normally a trusted certificate, but it can also be a path-validation error that can be discovered while constructing the input to this function and that is to be run through the <code>verify_fun</code>. Examples are <code>unknown_ca</code> and <code>selfsigned_peer.</code></li><li class="type">CertChain = [der_encoded()]</li><li class="description">A list of DER-encoded certificates in trust order ending with the peer certificate.</li><li class="type">Options = proplists:proplist()</li><li class="type">PublicKeyInfo = {?'rsaEncryption' | ?'id-RSASSA-PSS'| ?'id-dsa', rsa_public_key() | integer(), 'NULL' | 'RSASSA-PSS-params'{} | 'Dss-Parms'{}}</li><li class="type">PolicyTree = term()</li><li class="description">At the moment this is always an empty list as policies are not currently supported.</li><li class="type">Reason = cert_expired | invalid_issuer | invalid_signature | name_not_permitted | missing_basic_constraint | invalid_key_usage | {revoked, crl_reason()} | atom()</li></ul><p>Performs a basic path validation according to <a href="http://www.ietf.org/rfc/rfc5280.txt">RFC 5280.</a> However, CRL validation is done separately by <a href="public_key.html#pkix_crls_validate/3">pkix_crls_validate/3 </a>and is to be called from the supplied <code>verify_fun</code>.</p><p>Available options:</p><dl><dt>{verify_fun, {fun(), InitialUserState::term()}</dt><dd><p>The fun must be defined as:</p><pre><code class="makeup erlang"><span class="nf">fun</span><span class="p" data-group-id="1646601494-1">(</span><span class="n">OtpCert</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="o">#</span><span class="ss">&#39;OTPCertificate&#39;</span><span class="p" data-group-id="1646601494-2">{</span><span class="p" data-group-id="1646601494-2">}</span><span class="p">,</span><span class="w">
    </span><span class="n">Event</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1646601494-3">{</span><span class="ss">bad_cert</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="1646601494-4">(</span><span class="p" data-group-id="1646601494-4">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="1646601494-5">{</span><span class="ss">revoked</span><span class="p">,</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="1646601494-6">(</span><span class="p" data-group-id="1646601494-6">)</span><span class="p" data-group-id="1646601494-5">}</span><span class="p" data-group-id="1646601494-3">}</span><span class="w"> </span><span class="p">|</span><span class="w">
             </span><span class="p" data-group-id="1646601494-7">{</span><span class="ss">extension</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">&#39;Extension&#39;</span><span class="p" data-group-id="1646601494-8">{</span><span class="p" data-group-id="1646601494-8">}</span><span class="p" data-group-id="1646601494-7">}</span><span class="p">,</span><span class="w">
    </span><span class="n">InitialUserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="1646601494-9">(</span><span class="p" data-group-id="1646601494-9">)</span><span class="p" data-group-id="1646601494-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
</span><span class="err">	</span><span class="p" data-group-id="1646601494-10">{</span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="1646601494-11">(</span><span class="p" data-group-id="1646601494-11">)</span><span class="p" data-group-id="1646601494-10">}</span><span class="w"> </span><span class="p">|</span><span class="w">
</span><span class="err">	</span><span class="p" data-group-id="1646601494-12">{</span><span class="ss">valid_peer</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="1646601494-13">(</span><span class="p" data-group-id="1646601494-13">)</span><span class="p" data-group-id="1646601494-12">}</span><span class="w"> </span><span class="p">|</span><span class="w">
</span><span class="err">	</span><span class="p" data-group-id="1646601494-14">{</span><span class="ss">fail</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="1646601494-15">(</span><span class="p" data-group-id="1646601494-15">)</span><span class="p" data-group-id="1646601494-14">}</span><span class="w"> </span><span class="p">|</span><span class="w">
</span><span class="err">	</span><span class="p" data-group-id="1646601494-16">{</span><span class="ss">unknown</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="1646601494-17">(</span><span class="p" data-group-id="1646601494-17">)</span><span class="p" data-group-id="1646601494-16">}</span><span class="p">.</span><span class="w">
</span><span class="err">	</span><span class="w">  </span></code></pre><p>If the verify callback fun returns <code>{fail, Reason}</code>, the verification process is immediately stopped. If the verify callback fun returns <code>{valid, UserState}</code>, the verification process is continued. This can be used to accept specific path validation errors, such as <code>selfsigned_peer</code>, as well as verifying application-specific extensions. If called with an extension unknown to the user application, the return value <code>{unknown, UserState}</code> is to be used.</p><div class="warning"><p>Note that user defined custom <code>verify_fun</code> may alter original path validation error (e.g <code>selfsigned_peer</code>). Use with caution.</p></div></dd><dt>{max_path_length, integer()}</dt><dd>The <code>max_path_length</code> is the maximum number of non-self-issued intermediate certificates that can follow the peer certificate in a valid certification path. So, if <code>max_path_length</code> is 0, the PEER must be signed by the trusted ROOT-CA directly, if it is 1, the path can be PEER, CA, ROOT-CA, if it is 2, the path can be PEER, CA, CA, ROOT-CA, and so on.</dd></dl><p>Possible reasons for a bad certificate:</p><dl><dt>cert_expired</dt><dd><p>Certificate is no longer valid as its expiration date has passed.</p></dd><dt>invalid_issuer</dt><dd><p>Certificate issuer name does not match the name of the issuer certificate in the chain.</p></dd><dt>invalid_signature</dt><dd><p>Certificate was not signed by its issuer certificate in the chain.</p></dd><dt>name_not_permitted</dt><dd><p>Invalid Subject Alternative Name extension.</p></dd><dt>missing_basic_constraint</dt><dd><p>Certificate, required to have the basic constraints extension, does not have a basic constraints extension.</p></dd><dt>invalid_key_usage</dt><dd><p>Certificate key is used in an invalid way according to the key-usage extension.</p></dd><dt>{revoked, crl_reason()}</dt><dd><p>Certificate has been revoked.</p></dd><dt>atom()</dt><dd><p>Application-specific error reason that is to be checked by the <code>verify_fun</code>.</p></dd></dl>
  </section>
</section>
<section class="detail" id="pkix_sign/2">

  <div class="detail-header">
    <a href="#pkix_sign/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_sign/2</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_sign(Cert, Key) -> Der
             when Cert :: #'OTPTBSCertificate'{}, Key :: <a href="#t:private_key/0">private_key</a>(), Der :: <a href="#t:der_encoded/0">der_encoded</a>().</pre>

      </div>

<p>Signs an 'OTPTBSCertificate'. Returns the corresponding DER-encoded certificate.</p>
  </section>
</section>
<section class="detail" id="pkix_sign_types/1">

  <div class="detail-header">
    <a href="#pkix_sign_types/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_sign_types/1</h1>


      <span class="note">(since OTP R16B01)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_sign_types(AlgorithmId) -> {DigestType, SignatureType}
                   when
                       AlgorithmId :: <a href="#t:oid/0">oid</a>(),
                       DigestType :: <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:rsa_digest_type/0">crypto:rsa_digest_type</a>() | none,
                       SignatureType :: rsa | dsa | ecdsa.</pre>

      </div>

<p>Translates signature algorithm OID to Erlang digest and signature types.</p><p>The <code>AlgorithmId</code> is the signature OID from a certificate or a certificate revocation list.</p>
  </section>
</section>
<section class="detail" id="pkix_subject_id/1">

  <div class="detail-header">
    <a href="#pkix_subject_id/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_subject_id/1</h1>


      <span class="note">(since OTP 23.1)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_subject_id(Cert) -> ID when Cert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{}, ID :: <a href="#t:cert_id/0">cert_id</a>().</pre>

      </div>

<p>Returns the X509 certificate subject id.</p>
  </section>
</section>
<section class="detail" id="pkix_test_data/1">

  <div class="detail-header">
    <a href="#pkix_test_data/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_test_data([chain_opts()]) -&gt; [conf_opt()] pkix_test_data(Options) -&gt; Config </h1>


      <span class="note">(since OTP 20.1)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_test_data(#{<a href="#t:chain_type/0">chain_type</a>() := <a href="pubkey_cert.html#t:chain_opts/0">pubkey_cert:chain_opts</a>()} | <a href="pubkey_cert.html#t:chain_opts/0">pubkey_cert:chain_opts</a>()) ->
                  <a href="pubkey_cert.html#t:test_config/0">pubkey_cert:test_config</a>() | [<a href="pubkey_cert.html#t:conf_opt/0">pubkey_cert:conf_opt</a>()].</pre>

      </div>

<ul class="types"><li class="type">Options = #{chain_type() := chain_opts()}</li><li class="description">Options for ROOT, Intermediate and Peer certs</li><li class="type">chain_type() = server_chain | client_chain</li><li class="type">chain_opts() = #{root := [cert_opt()] | root_cert(), peer := [cert_opt()], intermediates =&gt; [[cert_opt()]]}</li><li class="description">A valid chain must have at least a ROOT and a peer cert. The root cert can be given either as a cert pre-generated by <a href="public_key.html#pkix_test_root_cert/2">pkix_test_root_cert/2 </a>, or as root cert generation options.</li><li class="type">root_cert() = #{cert := der_encoded(), key := Key}</li><li class="description">A root certificate generated by <a href="public_key.html#pkix_test_root_cert/2">pkix_test_root_cert/2 </a>.</li><li class="type">cert_opt() = {Key, Value}</li><li class="description">For available options see <a href="public_key.html#content#cert_opt">cert_opt()</a> below.</li><li class="type">Config = #{server_config := [conf_opt()], client_config := [conf_opt()]}</li><li class="type">conf_opt() = {cert, der_encoded()} | {key, PrivateKey} |{cacerts, [der_encoded()]}</li><li class="description">This is a subset of the type <a href="https://wojtekmach.pl/otp_docs/ssl/ssl.html#t:tls_option/0">ssl:tls_option()</a>. <code>PrivateKey</code> is what <a href="public_key.html#generate_key/1">generate_key/1</a> returns.</li></ul><p>Creates certificate configuration(s) consisting of certificate and its private key plus CA certificate bundle, for a client and a server, intended to facilitate automated testing of applications using X509-certificates, often through SSL/TLS. The test data can be used when you have control over both the client and the server in a test scenario.</p><p>When this function is called with a map containing client and server chain specifications; it generates both a client and a server certificate chain where the <code>cacerts</code> returned for the server contains the root cert the server should trust and the intermediate certificates the server should present to connecting clients. The root cert the server should trust is the one used as root of the client certificate chain. Vice versa applies to the <code>cacerts</code> returned for the client. The root cert(s) can either be pre-generated with <a href="public_key.html#pkix_test_root_cert/2">pkix_test_root_cert/2 </a>, or if options are specified; it is (they are) generated.</p><p>When this function is called with a list of certificate options; it generates a configuration with just one node certificate where <code>cacerts</code> contains the root cert and the intermediate certs that should be presented to a peer. In this case the same root cert must be used for all peers. This is useful in for example an Erlang distributed cluster where any node, towards another node, acts either as a server or as a client depending on who connects to whom. The generated certificate contains a subject altname, which is not needed in a client certificate, but makes the certificate useful for both roles.</p><p>The <a id="cert_opt"></a><code>cert_opt()</code> type consists of the following options:</p><dl><dt>{digest, digest_type()}</dt><dd><p>Hash algorithm to be used for signing the certificate together with the key option. Defaults to sha that is sha1.</p></dd><dt>{key, key_params() | private_key()}</dt><dd><p>Parameters to be used to call public_key:generate_key/1, to generate a key, or an existing key. Defaults to generating an ECDSA key. Note this could fail if Erlang/OTP is compiled with a very old cryptolib.</p></dd><dt>{validity, {From::erlang:timestamp(), To::erlang:timestamp()}}</dt><dd><p>The validity period of the certificate.</p></dd><dt>{extensions, [#'Extension'{}]}</dt><dd><p>Extensions to include in the certificate.</p><p>Default extensions included in CA certificates if not otherwise specified are:</p><pre><code class="makeup erlang"><span class="p" data-group-id="6969088280-1">[</span><span class="o">#</span><span class="ss">&#39;Extension&#39;</span><span class="p" data-group-id="6969088280-2">{</span><span class="ss">extnID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="ss">&#39;id-ce-keyUsage&#39;</span><span class="p">,</span><span class="w">
              </span><span class="ss">extnValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="6969088280-3">[</span><span class="ss">keyCertSign</span><span class="p">,</span><span class="w"> </span><span class="ss">cRLSign</span><span class="p" data-group-id="6969088280-3">]</span><span class="p">,</span><span class="w">
              </span><span class="ss">critical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="6969088280-2">}</span><span class="p">,</span><span class="w">
</span><span class="o">#</span><span class="ss">&#39;Extension&#39;</span><span class="p" data-group-id="6969088280-4">{</span><span class="ss">extnID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="ss">&#39;id-ce-basicConstraints&#39;</span><span class="p">,</span><span class="w">
             </span><span class="ss">extnValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">#</span><span class="ss">&#39;BasicConstraints&#39;</span><span class="p" data-group-id="6969088280-5">{</span><span class="ss">cA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="6969088280-5">}</span><span class="p">,</span><span class="w">
             </span><span class="ss">critical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="6969088280-4">}</span><span class="p" data-group-id="6969088280-1">]</span><span class="w">
</span><span class="err">	</span><span class="w">  </span></code></pre><p>Default extensions included in the server peer cert if not otherwise specified are:</p><pre><code class="makeup erlang"><span class="p" data-group-id="5670653599-1">[</span><span class="o">#</span><span class="ss">&#39;Extension&#39;</span><span class="p" data-group-id="5670653599-2">{</span><span class="ss">extnID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="ss">&#39;id-ce-keyUsage&#39;</span><span class="p">,</span><span class="w">
              </span><span class="ss">extnValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5670653599-3">[</span><span class="ss">digitalSignature</span><span class="p">,</span><span class="w"> </span><span class="ss">keyAgreement</span><span class="p" data-group-id="5670653599-3">]</span><span class="p">,</span><span class="w">
              </span><span class="ss">critical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="5670653599-2">}</span><span class="p">,</span><span class="w">
</span><span class="o">#</span><span class="ss">&#39;Extension&#39;</span><span class="p" data-group-id="5670653599-4">{</span><span class="ss">extnID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="ss">&#39;id-ce-subjectAltName&#39;</span><span class="p">,</span><span class="w">
             </span><span class="ss">extnValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5670653599-5">[</span><span class="p" data-group-id="5670653599-6">{</span><span class="ss">dNSName</span><span class="p">,</span><span class="w"> </span><span class="n">Hostname</span><span class="p" data-group-id="5670653599-6">}</span><span class="p" data-group-id="5670653599-5">]</span><span class="p">,</span><span class="w">
             </span><span class="ss">critical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="5670653599-4">}</span><span class="p" data-group-id="5670653599-1">]</span><span class="w">
</span><span class="err">	</span><span class="w">  </span></code></pre><p>Hostname is the result of calling net_adm:localhost() in the Erlang node where this funcion is called.</p></dd></dl><div class="note"><p>Note that the generated certificates and keys does not provide a formally correct PKIX-trust-chain and they cannot be used to achieve real security. This function is provided for testing purposes only.</p></div>
  </section>
</section>
<section class="detail" id="pkix_test_root_cert/2">

  <div class="detail-header">
    <a href="#pkix_test_root_cert/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_test_root_cert(Name, Options) -&gt; RootCert</h1>


      <span class="note">(since OTP 20.2)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_test_root_cert(Name, Options) -> RootCert
                       when
                           Name :: string(),
                           Options :: [{atom(), term()}],
                           RootCert :: <a href="pubkey_cert.html#t:test_root_cert/0">pubkey_cert:test_root_cert</a>().</pre>

      </div>

<ul class="types"><li class="type">Name = string()</li><li class="description">The root certificate name.</li><li class="type">Options = [cert_opt()]</li><li class="description">For available options see <a href="public_key.html#content#cert_opt">cert_opt()</a> under <a href="public_key.html#pkix_test_data/1">pkix_test_data/1</a>.</li><li class="type">RootCert = #{cert := der_encoded(), key := Key}</li><li class="description">A root certificate and key. The <code>Key</code> is generated by <a href="public_key.html#generate_key/1">generate_key/1</a>.</li></ul><p>Generates a root certificate that can be used in multiple calls to <a href="public_key.html#pkix_test_data/1">pkix_test_data/1</a> when you want the same root certificate for several generated certificates.</p>
  </section>
</section>
<section class="detail" id="pkix_verify/2">

  <div class="detail-header">
    <a href="#pkix_verify/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_verify/2</h1>


      <span class="note">(since OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_verify(Cert, Key) -> boolean() when Cert :: <a href="#t:der_encoded/0">der_encoded</a>(), Key :: <a href="#t:public_key/0">public_key</a>().</pre>

      </div>

<p>Verifies PKIX x.509 certificate signature.</p>
  </section>
</section>
<section class="detail" id="pkix_verify_hostname/2">

  <div class="detail-header">
    <a href="#pkix_verify_hostname/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_verify_hostname(Cert, ReferenceIDs) -&gt; boolean()</h1>


      <span class="note">(since OTP 19.3)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_verify_hostname(Cert, ReferenceIDs) -> boolean()
                        when
                            Cert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{},
                            ReferenceIDs :: <a href="#t:referenceIDs/0">referenceIDs</a>().</pre>

      </div>

<ul class="types"><li class="type">Cert = der_encoded() | #'OTPCertificate'{}</li><li class="type">ReferenceIDs = [ RefID ]</li><li class="type">RefID = {dns_id,string()} | {srv_id,string()} | {uri_id,string()} | {ip,inet:ip_address()|string()} | {OtherRefID,term()}}</li><li class="type">OtherRefID = atom()</li><li class="type">Opts = [ PvhOpt() ]</li><li class="type">PvhOpt = [MatchOpt | FailCallBackOpt | FqdnExtractOpt]</li><li class="type">MatchOpt = {match_fun, fun(RefId | FQDN::string(), PresentedID) -&gt; boolean() | default}</li><li class="type">PresentedID = {dNSName,string()} | {uniformResourceIdentifier,string() | {iPAddress,list(byte())} | {OtherPresId,term()}}</li><li class="type">OtherPresID = atom()</li><li class="type">FailCallBackOpt = {fail_callback, fun(#'OTPCertificate'{}) -&gt; boolean()}</li><li class="type">FqdnExtractOpt = {fqdn_fun, fun(RefID) -&gt; FQDN::string() | default | undefined}</li></ul><p>This function checks that the <i>Presented Identifier</i> (e.g hostname) in a peer certificate is in agreement with at least one of the <i>Reference Identifier</i> that the client expects to be connected to. The function is intended to be added as an extra client check of the peer certificate when performing <a href="public_key.html#pkix_path_validation/3">public_key:pkix_path_validation/3</a></p><p>See <a href="https://tools.ietf.org/html/rfc6125">RFC 6125</a> for detailed information about hostname verification. The User's Guide and code examples describes this function more detailed.</p><p>The <code>{OtherRefId,term()}</code> is defined by the user and is passed to the <code>match_fun</code>, if defined. If the term in <code>OtherRefId</code> is a binary, it will be converted to a string.</p><p>The <code>ip</code> Reference ID takes an <a href="https://wojtekmach.pl/otp_docs/kernel/inet.html#t:ip_address/0">inet:ip_address()</a> or an ip address in string format (E.g &quot;10.0.1.1&quot; or &quot;1234::5678:9012&quot;) as second element.</p><p>The options are:</p><dl><dt><code>match_fun</code></dt><dd>The <code>fun/2</code> in this option replaces the default host name matching rules. The fun should return a boolean to tell if the Reference ID and Presented ID matches or not. The fun can also return a third value, the atom <code>default</code>, if the default matching rules shall apply. This makes it possible to augment the tests with a special case:<pre><code class="makeup erlang"><span class="nf">fun</span><span class="p" data-group-id="7709005803-1">(</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="7709005803-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">true</span><span class="p">;</span><span class="w">   </span><span class="c1">% My special case</span><span class="w">
   </span><span class="p" data-group-id="7709005803-2">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="7709005803-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">default</span><span class="w"> </span><span class="c1">% all others falls back to the inherit tests</span><span class="w">
</span><span class="k">end</span><span class="w">
</span><span class="err">	</span><span class="w">  </span></code></pre><br/>See <a href="public_key.html#pkix_verify_hostname_match_fun/1">pkix_verify_hostname_match_fun/1</a> for a function that takes a protocol name as argument and returns a <code>fun/2</code> suitable for this option and Re-defining the match operation in the User's Guide for an example.</dd><dt><code>fail_callback</code></dt><dd>If a matching fails, there could be circumstances when the certificate should be accepted anyway. Think for example of a web browser where you choose to accept an outdated certificate. This option enables implementation of such a function. This <code>fun/1</code> is called when no <code>ReferenceID</code> matches. The return value of the fun (a <code>boolean()</code>) decides the outcome. If <code>true</code> the the certificate is accepted otherwise it is rejected. See &quot;Pinning&quot; a Certificate in the User's Guide.</dd><dt><code>fqdn_fun</code></dt><dd>This option augments the host name extraction from URIs and other Reference IDs. It could for example be a very special URI that is not standardised. The fun takes a Reference ID as argument and returns one of:<ul><li>the hostname</li><li>the atom <code>default</code>: the default host name extract function will be used</li><li>the atom <code>undefined</code>: a host name could not be extracted. The pkix_verify_hostname/3 will return <code>false</code>.</li></ul><br/>For an example, see Hostname extraction in the User's Guide.</dd></dl>
  </section>
</section>
<section class="detail" id="pkix_verify_hostname/3">

  <div class="detail-header">
    <a href="#pkix_verify_hostname/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_verify_hostname(Cert, ReferenceIDs, Opts) -&gt; boolean()</h1>


      <span class="note">(since OTP 19.3)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_verify_hostname(Cert, ReferenceIDs, Options) -> boolean()
                        when
                            Cert :: <a href="#t:der_encoded/0">der_encoded</a>() | #'OTPCertificate'{},
                            ReferenceIDs :: <a href="#t:referenceIDs/0">referenceIDs</a>(),
                            Options :: [{atom(), term()}].</pre>

      </div>


  </section>
</section>
<section class="detail" id="pkix_verify_hostname_match_fun/1">

  <div class="detail-header">
    <a href="#pkix_verify_hostname_match_fun/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">pkix_verify_hostname_match_fun(Protcol) -&gt;  fun(RefId | FQDN::string(), PresentedID) -&gt; boolean() | default</h1>


      <span class="note">(since OTP 21.0)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>pkix_verify_hostname_match_fun(<a href="#t:high_level_alg/0">high_level_alg</a>()) -> <a href="#t:match_fun/0">match_fun</a>().</pre>

      </div>

<ul class="types"><li class="type">Protocol = https</li><li class="description">The algorithm for wich the fun should implement the special matching rules</li><li class="type">RefId</li><li class="description">See <a href="public_key.html#pkix_verify_hostname/3">pkix_verify_hostname/3</a>.</li><li class="type">FQDN</li><li class="description">See <a href="public_key.html#pkix_verify_hostname/3">pkix_verify_hostname/3</a>.</li><li class="type">PresentedID</li><li class="description">See <a href="public_key.html#pkix_verify_hostname/3">pkix_verify_hostname/3</a>.</li></ul><p>The return value of calling this function is intended to be used in the <code>match_fun</code> option in <a href="public_key.html#pkix_verify_hostname/3">pkix_verify_hostname/3</a>.</p><p>The returned fun augments the verify hostname matching according to the specific rules for the protocol in the argument.</p>
  </section>
</section>
<section class="detail" id="short_name_hash/1">

  <div class="detail-header">
    <a href="#short_name_hash/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">short_name_hash/1</h1>


      <span class="note">(since OTP 19.0)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>short_name_hash(Name) -> string() when Name :: <a href="#t:issuer_name/0">issuer_name</a>().</pre>

      </div>

<p>Generates a short hash of an issuer name. The hash is returned as a string containing eight hexadecimal digits.</p><p>The return value of this function is the same as the result of the commands <code>openssl crl -hash</code> and <code>openssl x509 -issuer_hash</code>, when passed the issuer name of a CRL or a certificate, respectively. This hash is used by the <code>c_rehash</code> tool to maintain a directory of symlinks to CRL files, in order to facilitate looking up a CRL by its issuer name.</p>
  </section>
</section>
<section class="detail" id="sign/3">

  <div class="detail-header">
    <a href="#sign/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">sign/3</h1>


      <span class="note">(since OTP 20.1)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>sign(Msg, DigestType, Key) -> Signature
        when
            Msg :: binary() | {digest, binary()},
            DigestType :: <a href="#t:digest_type/0">digest_type</a>(),
            Key :: <a href="#t:private_key/0">private_key</a>(),
            Signature :: binary().</pre>

      </div>

<p>Creates a digital signature.</p><p>The <code>Msg</code> is either the binary &quot;plain text&quot; data to be signed or it is the hashed value of &quot;plain text&quot;, that is, the digest.</p>
  </section>
</section>
<section class="detail" id="sign/4">

  <div class="detail-header">
    <a href="#sign/4" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">sign/4</h1>


      <span class="note">(since OTP 20.1)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>sign(Msg, DigestType, Key, Options) -> Signature
        when
            Msg :: binary() | {digest, binary()},
            DigestType :: <a href="#t:digest_type/0">digest_type</a>(),
            Key :: <a href="#t:private_key/0">private_key</a>(),
            Options :: <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:pk_sign_verify_opts/0">crypto:pk_sign_verify_opts</a>(),
            Signature :: binary().</pre>

      </div>


  </section>
</section>
<section class="detail" id="ssh_decode/2">

  <div class="detail-header">
    <a href="#ssh_decode/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">ssh_decode/2</h1>


      <span class="note">(since OTP R14B03)</span>

  </div>

    <div class="deprecated">
      This function is deprecated. public_key:ssh_decode/2 is deprecated and will be removed in OTP 26; use ssh_file:decode/2 instead.
    </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ssh_decode(SshBin, Type) -> Decoded
              when
                  SshBin :: binary(),
                  Type :: ssh2_pubkey | OtherType | InternalType,
                  OtherType :: public_key | <a href="#t:ssh_file/0">ssh_file</a>(),
                  InternalType :: new_openssh,
                  Decoded :: Decoded_ssh2_pubkey | Decoded_OtherType,
                  Decoded_ssh2_pubkey :: <a href="#t:public_key/0">public_key</a>(),
                  Decoded_OtherType :: [{<a href="#t:public_key/0">public_key</a>(), Attributes}],
                  Attributes :: [{atom(), term()}].</pre>

      </div>

<div class="note"><p>This function is deprecated and should not be used in new programs. Use <a href="https://wojtekmach.pl/otp_docs/ssh/ssh_file.html#decode/2">ssh_file:decode/2</a> instead.</p></div><p>Decodes an SSH file-binary. In the case of <code>known_hosts</code> or <code>auth_keys</code>, the binary can include one or more lines of the file. Returns a list of public keys and their attributes, possible attribute values depends on the file type represented by the binary.</p><p>If the <code>Type</code> is <code>ssh2_pubkey</code>, the result will be <code>Decoded_ssh2_pubkey</code>. Otherwise it will be <code>Decoded_OtherType</code>.</p><dl><dt>RFC4716 attributes - see RFC 4716.</dt><dd><p>{headers, [{string(), utf8_string()}]}</p></dd><dt>auth_key attributes - see manual page for sshd.</dt><dd>{comment, string()}</dd><dd>{options, [string()]}</dd><dd><p>{bits, integer()} - In SSH version 1 files.</p></dd><dt>known_host attributes - see manual page for sshd.</dt><dd>{hostnames, [string()]}</dd><dd>{comment, string()}</dd><dd><p>{bits, integer()} - In SSH version 1 files.</p></dd></dl><p>Example: <code>{ok, SshBin} = file:read_file(&quot;known_hosts&quot;)</code>.</p><p>If <code>Type</code> is <code>public_key</code> the binary can be either an RFC4716 public key or an OpenSSH public key.</p>
  </section>
</section>
<section class="detail" id="ssh_encode/2">

  <div class="detail-header">
    <a href="#ssh_encode/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">ssh_encode/2</h1>


      <span class="note">(since OTP R14B03)</span>

  </div>

    <div class="deprecated">
      This function is deprecated. public_key:ssh_encode/2 is deprecated and will be removed in OTP 26; use ssh_file:encode/2 instead.
    </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ssh_encode(InData, Type) -> binary()
              when
                  Type :: ssh2_pubkey | OtherType,
                  OtherType :: public_key | <a href="#t:ssh_file/0">ssh_file</a>(),
                  InData :: InData_ssh2_pubkey | OtherInData,
                  InData_ssh2_pubkey :: <a href="#t:public_key/0">public_key</a>(),
                  OtherInData :: [{Key, Attributes}],
                  Key :: <a href="#t:public_key/0">public_key</a>(),
                  Attributes :: [{atom(), term()}].</pre>

      </div>

<div class="note"><p>This function is deprecated and should not be used in new programs. Use <a href="https://wojtekmach.pl/otp_docs/ssh/ssh_file.html#encode/2">ssh_file:encode/2</a> instead.</p></div><p>Encodes a list of SSH file entries (public keys and attributes) to a binary. Possible attributes depend on the file type, see <a href="public_key.html#ssh_decode/2">ssh_decode/2 </a>.</p><p>If the <code>Type</code> is <code>ssh2_pubkey</code>, the <code>InData</code> shall be <code>InData_ssh2_pubkey</code>. Otherwise it shall be <code>OtherInData</code>.</p>
  </section>
</section>
<section class="detail" id="ssh_hostkey_fingerprint/1">

  <div class="detail-header">
    <a href="#ssh_hostkey_fingerprint/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">ssh_hostkey_fingerprint(HostKey) -&gt; string()</h1>


      <span class="note">(since OTP 19.2)</span>

  </div>

    <div class="deprecated">
      This function is deprecated. public_key:ssh_hostkey_fingerprint/1 is deprecated and will be removed in OTP 26; use ssh:hostkey_fingerprint/1 instead.
    </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ssh_hostkey_fingerprint(<a href="#t:public_key/0">public_key</a>()) -> string().</pre>

      </div>

<ul class="types"><li class="type">HostKey = <a href="public_key.html#t:public_key/0">public_key()</a></li><li class="type">DigestType = <a href="public_key.html#t:digest_type/0">digest_type()</a></li></ul><p>Calculates a ssh fingerprint from a public host key as openssh does.</p><div class="note"><p>This function is deprecated and should not be used in new programs. Use <a href="https://wojtekmach.pl/otp_docs/ssh/ssh.html#hostkey_fingerprint/1">ssh:hostkey_fingerprint/1</a> or <a href="https://wojtekmach.pl/otp_docs/ssh/ssh.html#hostkey_fingerprint/2">ssh:hostkey_fingerprint/2</a> instead.</p></div><p>The algorithm in <code>ssh_hostkey_fingerprint/1</code> is md5 to be compatible with older ssh-keygen commands. The string from the second variant is prepended by the algorithm name in uppercase as in newer ssh-keygen commands.</p><p>Examples:</p><pre><code class="makeup erlang"><span class="w"> </span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">public_key</span><span class="p">:</span><span class="nf">ssh_hostkey_fingerprint</span><span class="p" data-group-id="6816694595-1">(</span><span class="n">Key</span><span class="p" data-group-id="6816694595-1">)</span><span class="p">.</span><span class="w">    
 </span><span class="s">&quot;f5:64:a6:c1:5a:cb:9f:0a:10:46:a2:5c:3e:2f:57:84&quot;</span><span class="w">

 </span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">public_key</span><span class="p">:</span><span class="nf">ssh_hostkey_fingerprint</span><span class="p" data-group-id="6816694595-2">(</span><span class="nb">md5</span><span class="p">,</span><span class="n">Key</span><span class="p" data-group-id="6816694595-2">)</span><span class="p">.</span><span class="w">
 </span><span class="s">&quot;MD5:f5:64:a6:c1:5a:cb:9f:0a:10:46:a2:5c:3e:2f:57:84&quot;</span><span class="w">

 </span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">public_key</span><span class="p">:</span><span class="nf">ssh_hostkey_fingerprint</span><span class="p" data-group-id="6816694595-3">(</span><span class="ss">sha</span><span class="p">,</span><span class="n">Key</span><span class="p" data-group-id="6816694595-3">)</span><span class="p">.</span><span class="w">
 </span><span class="s">&quot;SHA1:bSLY/C4QXLDL/Iwmhyg0PGW9UbY&quot;</span><span class="w">

 </span><span class="mi">5</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">public_key</span><span class="p">:</span><span class="nf">ssh_hostkey_fingerprint</span><span class="p" data-group-id="6816694595-4">(</span><span class="ss">sha256</span><span class="p">,</span><span class="n">Key</span><span class="p" data-group-id="6816694595-4">)</span><span class="p">.</span><span class="w">
 </span><span class="s">&quot;SHA256:aZGXhabfbf4oxglxltItWeHU7ub3Dc31NcNw2cMJePQ&quot;</span><span class="w">

 </span><span class="mi">6</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">public_key</span><span class="p">:</span><span class="nf">ssh_hostkey_fingerprint</span><span class="p" data-group-id="6816694595-5">(</span><span class="p" data-group-id="6816694595-6">[</span><span class="ss">sha</span><span class="p">,</span><span class="ss">sha256</span><span class="p" data-group-id="6816694595-6">]</span><span class="p">,</span><span class="n">Key</span><span class="p" data-group-id="6816694595-5">)</span><span class="p">.</span><span class="w">
 </span><span class="p" data-group-id="6816694595-7">[</span><span class="s">&quot;SHA1:bSLY/C4QXLDL/Iwmhyg0PGW9UbY&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s">&quot;SHA256:aZGXhabfbf4oxglxltItWeHU7ub3Dc31NcNw2cMJePQ&quot;</span><span class="p" data-group-id="6816694595-7">]</span><span class="w">
    </span></code></pre>
  </section>
</section>
<section class="detail" id="ssh_hostkey_fingerprint/2">

  <div class="detail-header">
    <a href="#ssh_hostkey_fingerprint/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">ssh_hostkey_fingerprint([DigestType], HostKey) -&gt; [string()] ssh_hostkey_fingerprint(DigestType, HostKey) -&gt; string()</h1>


      <span class="note">(since OTP 19.2)</span>

  </div>

    <div class="deprecated">
      This function is deprecated. public_key:ssh_hostkey_fingerprint/2 is deprecated and will be removed in OTP 26; use ssh:hostkey_fingerprint/2 instead.
    </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>ssh_hostkey_fingerprint(<a href="#t:digest_type/0">digest_type</a>(), <a href="#t:public_key/0">public_key</a>()) -> string();
                       ([<a href="#t:digest_type/0">digest_type</a>()], <a href="#t:public_key/0">public_key</a>()) -> [string()].</pre>

      </div>


  </section>
</section>
<section class="detail" id="verify/4">

  <div class="detail-header">
    <a href="#verify/4" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">verify/4</h1>


      <span class="note">(since OTP 20.1,OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>verify(Msg, DigestType, Signature, Key) -> boolean()
          when
              Msg :: binary() | {digest, binary()},
              DigestType :: <a href="#t:digest_type/0">digest_type</a>(),
              Signature :: binary(),
              Key :: <a href="#t:public_key/0">public_key</a>().</pre>

      </div>

<p>Verifies a digital signature.</p><p>The <code>Msg</code> is either the binary &quot;plain text&quot; data or it is the hashed value of &quot;plain text&quot;, that is, the digest.</p>
  </section>
</section>
<section class="detail" id="verify/5">

  <div class="detail-header">
    <a href="#verify/5" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">verify/5</h1>


      <span class="note">(since OTP 20.1,OTP R14B)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>verify(Msg, DigestType, Signature, Key, Options) -> boolean()
          when
              Msg :: binary() | {digest, binary()},
              DigestType :: <a href="#t:digest_type/0">digest_type</a>(),
              Signature :: binary(),
              Key :: <a href="#t:public_key/0">public_key</a>(),
              Options :: <a href="https://wojtekmach.pl/otp_docs/crypto/crypto.html#t:pk_sign_verify_opts/0">crypto:pk_sign_verify_opts</a>().</pre>

      </div>


  </section>
</section>

          </div>
        </section>

      <footer class="footer">

        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.25.1) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>

            <a href="api-reference.html" title="API reference" class="line footer-button">API Reference</a>

          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
