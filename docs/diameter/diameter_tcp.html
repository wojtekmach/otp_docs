<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.25.1">
    <meta name="project" content="diameter v2.2.4">

    <title>diameter_tcp â€” diameter v2.2.4</title>
    <link rel="stylesheet" href="dist/erlang-951161c89561e05735a5.css" />

    <script src="dist/sidebar_items-1f263da3c3.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/app-f97730d45ef67f3e6188.js"></script>


  </head>
  <body data-type="modules">
    <script>

      try {
        if (localStorage.getItem('night-mode') === 'true') {
          document.body.classList.add('night-mode');
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="api-reference.html" class="sidebar-projectName">
diameter
      </a>
      <strong class="sidebar-projectVersion">
        v2.2.4
      </strong>
    </div>

  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list-link" href="#full-list">Pages</a></li>

      <li><a id="modules-list-link" href="#full-list">Modules</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

      <h1>
diameter_tcp <small class="app-vsn">(diameter v2.2.4)</small>

      </h1>


        <section id="moduledoc">
<p>This module implements diameter transport over TCP using <a href="https://wojtekmach.pl/otp_docs/kernel/gen_tcp.html">gen_tcp(3)</a>. It can be specified as the value of a <code>transport_module</code> option to <a href="diameter.html#add_transport/2">diameter:add_transport/2</a> and implements the behaviour documented in <a href="diameter_transport.html">diameter_transport(3)</a>. TLS security is supported, either as an upgrade following capabilities exchange or at connection establishment.</p><p>Note that the ssl application is required for TLS and must be started before configuring TLS capability on diameter transports.</p><a id="start"></a><h2 id="module-see-also" class="section-heading">
  <a href="#module-see-also" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  SEE ALSO
</h2>
<p><a href="diameter.html">diameter(3)</a>, <a href="diameter_transport.html">diameter_transport(3)</a>, <a href="https://wojtekmach.pl/otp_docs/kernel/gen_tcp.html">gen_tcp(3)</a>, <a href="https://wojtekmach.pl/otp_docs/kernel/inet.html">inet(3)</a>, <a href="https://wojtekmach.pl/otp_docs/ssl/ssl.html">ssl(3)</a></p>
        </section>


        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>

  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#start/3">start({Type, Ref}, Svc, [Opt])
         -&gt; {ok, Pid}
          | {ok, Pid, [LAddr]}
          | {error, Reason}</a>

  </div>

    <div class="summary-synopsis"><ul class="types"><li class="type">Type = connect | accept</li><li class="type">Ref = <a href="diameter.html#transport_ref">diameter:transport_ref()</a></li><li class="type">Svc = #diameter_service{}</li><li class="type">Opt = OwnOpt | SslOpt | TcpOpt</li><li class="type">Pid = pid()</li><li class="type">LAddr = <a href="https://wojtekmach.pl/otp_docs/kernel/inet.html#t:ip_address/0">inet:ip_address()</a></li><li class="type">Reason = term()</li><li class="type">OwnOpt = {raddr, <a href="https://wojtekmach.pl/otp_docs/kernel/inet.html#t:ip_address/0">inet:ip_address()</a>} | {rport, integer()} | {accept, Match} | {port, integer()} | {fragment_timer, infinity | 0..16#FFFFFFFF} | {message_cb, <a href="diameter.html#eval">diameter:eval()</a>} | {sender, boolean()}</li><li class="type">SslOpt = {ssl_options, true | list()}</li><li class="type">TcpOpt = term()</li><li class="type">Match = <a href="https://wojtekmach.pl/otp_docs/kernel/inet.html#t:ip_address/0">inet:ip_address()</a> | string() | [Match]</li></ul><p>The start function required by <a href="diameter_transport.html">diameter_transport(3)</a>.</p></div>

</div>

  </div>

        </section>


        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Functions
          </h1>
          <div class="functions-list">
<section class="detail" id="start/3">

  <div class="detail-header">
    <a href="#start/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">start({Type, Ref}, Svc, [Opt])
         -&gt; {ok, Pid}
          | {ok, Pid, [LAddr]}
          | {error, Reason}</h1>


      <span class="note">(since OTP R14B03)</span>

  </div>

  <section class="docstring">

      <h2>Specs</h2>
      <div class="specs">

          <pre>start({accept, Ref}, #diameter_service{}, [listen_option()]) -> {ok, pid(), [<a href="https://wojtekmach.pl/otp_docs/kernel/inet.html#t:ip_address/0">inet:ip_address</a>()]}
         when Ref :: diameter:transport_ref();
     ({connect, Ref}, #diameter_service{}, [connect_option()]) -> {ok, pid()}
         when Ref :: diameter:transport_ref().</pre>

      </div>

<ul class="types"><li class="type">Type = connect | accept</li><li class="type">Ref = <a href="diameter.html#transport_ref">diameter:transport_ref()</a></li><li class="type">Svc = #diameter_service{}</li><li class="type">Opt = OwnOpt | SslOpt | TcpOpt</li><li class="type">Pid = pid()</li><li class="type">LAddr = <a href="https://wojtekmach.pl/otp_docs/kernel/inet.html#t:ip_address/0">inet:ip_address()</a></li><li class="type">Reason = term()</li><li class="type">OwnOpt = {raddr, <a href="https://wojtekmach.pl/otp_docs/kernel/inet.html#t:ip_address/0">inet:ip_address()</a>} | {rport, integer()} | {accept, Match} | {port, integer()} | {fragment_timer, infinity | 0..16#FFFFFFFF} | {message_cb, <a href="diameter.html#eval">diameter:eval()</a>} | {sender, boolean()}</li><li class="type">SslOpt = {ssl_options, true | list()}</li><li class="type">TcpOpt = term()</li><li class="type">Match = <a href="https://wojtekmach.pl/otp_docs/kernel/inet.html#t:ip_address/0">inet:ip_address()</a> | string() | [Match]</li></ul><p>The start function required by <a href="diameter_transport.html">diameter_transport(3)</a>.</p><p>Options <code>raddr</code> and <code>rport</code> specify the remote address and port for a connecting transport and are not valid for a listening transport.</p><p>Option <code>accept</code> specifies remote addresses for a listening transport and is not valid for a connecting transport. If specified, a remote address that does not match one of the specified addresses causes the connection to be aborted. Multiple <code>accept</code> options can be specified. A string-valued <code>Match</code> that does not parse as an address is interpreted as a regular expression.</p><p>Option <code>ssl_options</code> must be specified for a transport that should support TLS: a value of <code>true</code> results in a TLS handshake immediately upon connection establishment while <code>list()</code> specifies options to be passed to <a href="https://wojtekmach.pl/otp_docs/ssl/ssl.html#connect/2">ssl:connect/2</a> or <a href="https://wojtekmach.pl/otp_docs/ssl/ssl.html#handshake/2">ssl:handshake/2</a> after capabilities exchange if TLS is negotiated.</p><p>Option <code>fragment_timer</code> specifies the timeout, in milliseconds, of a timer used to flush messages from the incoming byte stream even if the number of bytes indicated in the Message Length field of its Diameter Header have not yet been accumulated: such a message is received over the transport interface after two successive timeouts without the reception of additional bytes. Defaults to 1000.</p><a id="sender"></a><p>Option <code>sender</code> specifies whether or not to use a dedicated process for sending outgoing messages, which avoids the possibility of send blocking reception. Defaults to <code>false</code>. If set to <code>true</code> then a <code>message_cb</code> that avoids the possibility of messages being queued in the sender process without bound should be configured.</p><p>Option <code>message_cb</code> specifies a callback that is invoked on incoming and outgoing messages, that can be used to implement flow control. It is applied to two arguments: an atom indicating the reason for the callback (<code>send</code>, <code>recv</code>, or <code>ack</code> after a completed send), and the message in question (binary() on <code>recv</code>, binary() or diameter_packet record on <code>send</code> or <code>ack</code>, or <code>false</code> on <code>ack</code> when an incoming request has been discarded). It should return a list of actions and a new callback as tail; eg. <code>[fun cb/3, State]</code>. Valid actions are the atoms <code>send</code> or <code>recv</code>, to cause a following message-valued action to be sent/received, a message to send/receive (binary() or diameter_packet record), or a boolean() to enable/disable reading on the socket. More than one <code>send</code>/<code>recv</code>/message sequence can be returned from the same callback, and an initial <code>send</code>/<code>recv</code> can be omitted if the same as the value passed as the callback's first argument. Reading is initially enabled, and returning <code>false</code> does not imply there cannot be subsequent <code>recv</code> callbacks since messages may already have been read. An empty tail is equivalent to the prevailing callback. Defaults to a callback equivalent to <code>fun(ack, _) -&gt; []; (_, Msg) -&gt; [Msg] end</code>.</p><p>Remaining options are any accepted by <a href="https://wojtekmach.pl/otp_docs/ssl/ssl.html#connect/3">ssl:connect/3</a> or <a href="https://wojtekmach.pl/otp_docs/kernel/gen_tcp.html#connect/3">gen_tcp:connect/3</a> for a connecting transport, or <a href="https://wojtekmach.pl/otp_docs/ssl/ssl.html#listen/2">ssl:listen/2</a> or <a href="https://wojtekmach.pl/otp_docs/kernel/gen_tcp.html#listen/2">gen_tcp:listen/2</a> for a listening transport, depending on whether or not <code>{ssl_options, true}</code> has been specified. Options <code>binary</code>, <code>packet</code> and <code>active</code> cannot be specified. Also, option <code>port</code> can be specified for a listening transport to specify the local listening port, the default being the standardized 3868. Note that the option <code>ip</code> specifies the local address.</p><p>An <code>ssl_options</code> list must be specified if and only if the transport in question has set <code>Inband-Security-Id</code> to 1 (<code>TLS</code>), as specified to either <a href="diameter.html#start_service/2">diameter:start_service/2</a> or <a href="diameter.html#add_transport/2">diameter:add_transport/2</a>, so that the transport process will receive notification of whether or not to commence with a TLS handshake following capabilities exchange. Failing to specify an options list on a TLS-capable transport for which TLS is negotiated will cause TLS handshake to fail. Failing to specify TLS capability when <code>ssl_options</code> has been specified will cause the transport process to wait for a notification that will not be forthcoming, which will eventually cause the RFC 3539 watchdog to take down the connection.</p><p>The first element of a non-empty <code>Host-IP-Address</code> list in <code>Svc</code> provides the local IP address if an <code>ip</code> option is not specified. The local address is either returned from<a href="#start/3">start/3</a> or passed in a <code>connected</code> message over the transport interface.</p>
  </section>
</section>

          </div>
        </section>

      <footer class="footer">

        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.25.1) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>

            <a href="api-reference.html" title="API reference" class="line footer-button">API Reference</a>

          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
